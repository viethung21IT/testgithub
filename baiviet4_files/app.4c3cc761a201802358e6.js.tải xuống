(self.miniJsonp=self.miniJsonp||[]).push([[2143],{57387:function(e,t,n){"use strict";n.r(t),n.d(t,{createPortal:function(){return a},findDOMNode:function(){return c},flushSync:function(){return s},hydrate:function(){return u},render:function(){return i},unmountComponentAtNode:function(){return o},unstable_batchedUpdates:function(){return l}});var r=window.ReactDom,a=r.createPortal,o=r.unmountComponentAtNode,i=r.render,c=r.findDOMNode,s=r.flushSync,u=r.hydrate,l=r.unstable_batchedUpdates;t.default=r},501:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var r=n(58518),a=r.default.t.bind(r.default)},21218:function(e,t,n){"use strict";n(53426),n(62850),n(62773);var r=n(29494),a="VN",o="live";(0,r.init)(a,o,"8.7.0"),window.addExternalGlobal=function(e,t){if(window.__CHAT_GLOBAL__||(window.__CHAT_GLOBAL__={}),window.__CHAT_GLOBAL__[e])throw Error("Already Added!");window.__CHAT_GLOBAL__[e]=t},n.p="https://".concat(location.host.includes("cn")?"deo.shopeesz.com":"deo.shopeemobile.com","/shopee/shopee-seller-").concat(o,"-").concat(a.toLowerCase(),"/chateasy/");var i=n(86843),c=n(57387),s=n(55036),u=n(57209),l=n(44900),d=(n(27476),n(95767),n(98837),n(94882),n(98351),n(4942)),h=n(70885),f=n(53402),p=n(66633),m=n(96961),v=n(38104),w=function(e,t){var n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];n&&(clearTimeout(n),n=null),n=setTimeout((function(){e.apply(void 0,a)}),t)}};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=null,g=null,y="";function S(e){var t=e.currentConversation,n=void 0===t?{}:t,a=e.webChatUrl,o=e.source,i=e.chatWithType,c=void 0===i?r.ChatWithTypeEnum.Buyer:i;return(0,r.getItem)("mini-sc_redirect").then((function(e){e&&e.conversationId===n.id||(e={shopId:n.shop_id,userId:n.to_id,chatWithType:c});var t=E(E({},e),{},{type:"MiniChatRedirect"});o&&(t.miniSource=o),_&&!_.closed?(y!==a&&(_.location.href=a),_.focus()):(t.showConvsBeforePreload=!0,_=window.open("".concat(a),"_blank")),y=a,g&&window.clearInterval(g),g=window.setInterval((function(){try{_.postMessage(t,a)}catch(e){_=null,window.clearInterval(g)}}),1e3)}))}window.addEventListener("message",(function(e){var t;null!==(t=e.data)&&void 0!==t&&t.received&&window.clearInterval(g)}),!1);var b="https://".concat((0,r.getProjectUrl)("seller"),"/new-webchat/conversations"),N=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,r=(0,i.useRef)();(0,i.useEffect)((function(){r.current=t}),[t]),(0,i.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return r.current(e)};return n.addEventListener(e,t),function(){n.removeEventListener(n,t)}}}),[e,n])},O=n(20590),R=n.n(O),T={"chat-container":"aRLAkB8Zrm",chatContainer:"aRLAkB8Zrm",counts:"gAiLALcDL7",logo:"MMvRRRsryi",expandContainer:"GIWCwJZJzG",hover:"Z27mpOy85y","chaticon-wrapper":"Gf04Aiojki",chaticonWrapper:"Gf04Aiojki","chat-icon":"jZzeCQHIzA",chatIcon:"jZzeCQHIzA",root:"CDfxbn4ZiJ",hasUnread:"uZjpaOVZLe",jump:"j0lWW1yiAZ","jump-hover":"NuUu0k527Z",jumpHover:"NuUu0k527Z",jumpbar:"Oaw6LpGsn6","status-dot":"qkN6EH0q3W",statusDot:"qkN6EH0q3W",noUnread:"IZKX0usVWk",white:"L7EAUoJKzm",red:"obWep1e_86",windowContainer:"ZbkI8cjmb1",hint:"_XSJ6AR_TF",hintFooter:"Vwk9C74cna",btn:"WRwluoypn9","hide-btn":"XOHLYgO_ci WRwluoypn9",hideBtn:"XOHLYgO_ci WRwluoypn9","reply-btn":"apIkMBLaHt WRwluoypn9",replyBtn:"apIkMBLaHt WRwluoypn9"},k=n(29697),P=n(94184),I=n.n(P),D=n(41142),W=n.n(D),A=n(97139),U=n.n(A),L=n(87462),x=(n(19371),n(82139),n(15671)),j=n(43144),M=n(79340),q=n(82963),Z=n(61120),B={root:"lmRE8vX68Q",show:"sd52AxPSGC",hide:"PJHbR_Yd2l",icon:"rN6EXEam8W",success:"W7qaOmRY0O",fail:"H8ClYudgH1",error:"eFxCzEILZ1",info:"aZ9QwlAfiP",warn:"U_lOTqvndI",message:"uM6AUh43Zu"},H=n(96630),F=n(34652),V=n.n(F),z=n(86134),G=n.n(z),K=n(67838),X=n.n(K),Y=n(89069),J=n.n(Y);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,Z.Z)(e);if(t){var a=(0,Z.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,q.Z)(this,n)}}var te={transition:"opacity ".concat(200,"ms ease-in-out"),opacity:0},ne={success:V(),fail:G(),error:G(),info:J(),warn:X()},re={entering:{opacity:0},entered:{opacity:1},exiting:{opacity:1},exited:{opacity:0}},ae=function(e){(0,M.Z)(n,e);var t=ee(n);function n(e){var r;return(0,x.Z)(this,n),(r=t.call(this,e)).state={show:!1},r.timer=null,r.eventListenerAdded=!1,r}return(0,j.Z)(n,[{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"render",value:function(){var e=this,t=this.props.toast,n=t.type,r=t.message,a=this.state.show,o="".concat(B.root," ").concat(a?B.show:B.hide),c="".concat(B.icon," ").concat(B[n]),s=ne[n];return i.default.createElement(H.ZP,{in:a,timeout:200,addEndListener:function(t){e.eventListenerAdded||(t.addEventListener("transitionend",(function(){e.state.show&&(e.timer&&clearTimeout(e.timer),e.timer=setTimeout((function(){e.setState({show:!1},(function(){e.timer&&clearTimeout(e.timer),e.props.setToastInformation({toast:{type:"",message:"",show:!1}})}))}),1500))}),!1),e.eventListenerAdded=!0)}},(function(e){return i.default.createElement("div",{className:o,style:$($({},te),re[e])},s&&i.default.createElement(R(),{svg:s,className:c}),i.default.createElement("div",{className:B.message},r))}))}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.toast,n=t.message,r=t.show;return n?r?{show:r}:null:{show:!1}}}]),n}(i.default.PureComponent),oe=n.p+"1d65e1b1865219c9d05f.png",ie="gEBiGsPtJy",ce="yyHKyYrvkA",se="ZAV0ULHaxr",ue="auAKC8Ldbh",le="OnSxgsQlfi",de=n(501).t,he=function(){return i.default.createElement("div",{className:ie},i.default.createElement("div",{className:ce},i.default.createElement("img",{className:se,src:oe}),i.default.createElement("div",{className:ue},de("common.error.hint_text")),i.default.createElement("div",{className:le,onClick:function(){window.location.reload()}},de("common.error.reload"))))},fe="gLbzKNEAYF",pe="sIQQtRWQPz",me="Mj9lh6KccD",ve="yLzxr6DkWa",we="WHIaShCfot",Ce="QDLp_uN4bC",Ee=n(23018),_e=n.n(Ee),ge=n(84962),ye=n.n(ge),Se=(n(6059),n(97326)),be="hczDQaHbc3",Ne="Ht2E1kwC5D",Oe="bAKwNuP3ME",Re=n(94138),Te=n.n(Re),ke=n(501).t;function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,Z.Z)(e);if(t){var a=(0,Z.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,q.Z)(this,n)}}var Ie=function(e){(0,M.Z)(n,e);var t=Pe(n);function n(e){var r;return(0,x.Z)(this,n),(r=t.call(this,e)).state={hasError:!1},r.handleReload=r.handleReload.bind((0,Se.Z)(r)),r}return(0,j.Z)(n,[{key:"componentDidCatch",value:function(e){console.log("******* error",e),this.setState({hasError:!0})}},{key:"handleReload",value:function(){window.location.reload()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.shouldShowErrorPic,r=i.default.createElement("div",{className:be},n&&i.default.createElement(R(),{svg:Te(),className:Ne}),i.default.createElement("div",null,ke("common.error.load_failed"),i.default.createElement("span",{className:Oe,onClick:this.handleReload},ke("common.error.reload"))));return this.state.hasError?r:t}}]),n}(i.default.Component),De="EGGLy1QwiK",We="iTrdMlUViL",Ae="JVrP6W1yHV",Ue="lm0LkZVj3H",Le="tGULtQDa1B",xe="cq5bdsI9t0",je="bUDk9CxOKh",Me="X6WsSex6SN",qe=n(501).t,Ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){switch(t.name){case"profile":return i.default.createElement("div",{className:De},i.default.createElement(ye(),{half:!0}));case"input-field":return i.default.createElement("div",{className:Ue},i.default.createElement(ye(),{half:!0,className:Le}),i.default.createElement("div",{className:I()(We,je)},i.default.createElement("div",{className:Ae},i.default.createElement(ye(),{type:"square",className:xe}),i.default.createElement(ye(),{type:"square",className:xe}),i.default.createElement(ye(),{type:"square",className:xe}),i.default.createElement(ye(),{type:"square",className:xe}),i.default.createElement(ye(),{type:"square",className:xe})),i.default.createElement(ye(),{type:"square",className:xe})));default:return i.default.createElement("div",{className:Me},i.default.createElement(_e(),{isInit:!0,text:qe(t.loadingKey)||""}))}};return function(r){var a=n(),o="message-section"===t.name;return i.default.createElement(Ie,{shouldShowErrorPic:o},i.default.createElement(i.Suspense,{fallback:a},i.default.createElement(e,r)))}},Be=Ze((0,i.lazy)((function(){return Promise.all([n.e(951),n.e(311),n.e(785),n.e(5623),n.e(7425),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7625),n.e(6845)]).then(n.t.bind(n,67625,23))})),{name:"profile"}),He=Ze((0,i.lazy)((function(){return Promise.all([n.e(951),n.e(3093),n.e(311),n.e(454),n.e(785),n.e(1083),n.e(7917),n.e(7882),n.e(7026),n.e(5177),n.e(7520),n.e(7425),n.e(3101),n.e(7106),n.e(8058),n.e(5009),n.e(1395),n.e(6700),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(1593),n.e(664)]).then(n.t.bind(n,39725,23))})),{name:"input-field"}),Fe=Ze((0,i.lazy)((function(){return Promise.all([n.e(951),n.e(3093),n.e(454),n.e(785),n.e(4488),n.e(4255),n.e(7917),n.e(6587),n.e(4746),n.e(2099),n.e(6001),n.e(3962),n.e(370),n.e(2115),n.e(6938),n.e(1222),n.e(7707),n.e(7882),n.e(7026),n.e(8846),n.e(6462),n.e(4307),n.e(3378),n.e(6308),n.e(7905),n.e(3301),n.e(6051),n.e(5177),n.e(7520),n.e(3101),n.e(7106),n.e(8058),n.e(5009),n.e(1395),n.e(5814),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7417),n.e(5282),n.e(374)]).then(n.t.bind(n,84442,23))})),{name:"message-section",loadingKey:"common.loading"}),Ve=Ze((0,i.lazy)((function(){return n.e(2238).then(n.t.bind(n,65574,23))})),{name:"dropper"}),ze=function(e){var t=(0,i.useState)(!1),n=(0,h.Z)(t,2),a=n[0],o=n[1],c=(0,i.useState)([]),s=(0,h.Z)(c,2),u=s[0],l=s[1],d=e.shop,f=e.currentUser,p=e.currentBuyer,v=e.isSubAccount,w=e.currentConversation,C=e.drawerMedias,E=e.hasVideoPermission,_=e.setToastInformation,g=e.shopStatistics,y=e.isSidebarList,S=e.isDriver,b=e.currentAffiliate,N=function(e){e.preventDefault(),a&&o(!1)},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fail";_({toast:{show:!0,type:t,message:e}})};return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"".concat(fe," ").concat(y?pe:"")},i.default.createElement(Be,{shop:d,currentUser:f,currentBuyer:p,isSubAccount:v,currentConversation:w,shopStatistics:g,isSidebarList:y,currentAffiliate:b})),i.default.createElement("div",{className:"".concat(me," ").concat(y?ve:""),onDragEnter:function(e){e.preventDefault(),!a&&o(!0)}},a&&i.default.createElement(Ve,{onSuccess:function(e){var t=w.id,n=w.shop_id;l(e),(0,m.$tracker)({operation:r.TrackerOperation.ACTION_DRAG_VIDEO,section:"conversation_window",data:{conversation_id:t},shopId:n})},onDragOver:function(e){return e.preventDefault()},onDragLeave:N,onDrop:N,receiverName:w.to_name,hasVideoPermission:E&&!S,currentMediaNum:C.length,onError:O}),i.default.createElement("div",{id:"messagesContainer",className:we},i.default.createElement(Fe,{currentUser:f,currentConversation:w})),i.default.createElement("div",{className:Ce,style:{minHeight:"".concat(r.MINI_MIN_TEXT_BOX_HEIGHT,"px")}},i.default.createElement(He,{shop:d,currentUser:f,currentBuyer:p,isSubAccount:v,drawerMedias:C,draggedMedias:u,hasVideoPermission:E,currentConversation:w,handleErrorWithToast:O}))))},Ge=(0,s.connect)((function(e,t){var n=t.currentConversation,r=n.to_id,a=n.shop_id;return{drawerMedias:(0,p.mediaListSelector)(e),hasVideoPermission:(0,f.hasVideoPermissionSelector)(e),shop:(0,p.currentConversationShopSelectors)(e),shopStatistics:(0,f.shopStatisticsSelector)(r,a)(e),isDriver:(0,p.isDriverSelector)(e),currentAffiliate:(0,p.currentAffiliateSelector)(e)}}),null)(ze),Ke=n(16599),Xe=n.n(Ke),Ye=n(501).t;function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $e,et=(0,s.connect)((function(e){return{currentUserId:(0,f.currentUserIdSelector)(e),showRecallBanner:(0,f.showRecallBannerSelector)(e)}}),null)((function(e){var t=e.currentUserId,n=e.showRecallBanner,a=(0,i.useState)(!1),o=(0,h.Z)(a,2),c=o[0],s=o[1];if((0,i.useEffect)((function(){var e=(r.LS.getItem("mini-closeMessageExpiredAlert",!0)||{})[t];s(e)}),[t]),!(!c&&n))return null;return i.default.createElement(Xe(),{isBar:!0,showIcon:!0,content:Ye("chat.message_expired_tip"),closeable:!0,onClose:function(){var e=Qe(Qe({},r.LS.getItem("mini-closeMessageExpiredAlert",!0)||{}),{},(0,d.Z)({},t,!0));r.LS.setItem("mini-closeMessageExpiredAlert",e,!0),s(!0)}})})),tt=n(63662),nt=n.n(tt),rt=n(78640),at=n.n(rt),ot=(n(75929),n(35519),n(6646)),it=n.n(ot),ct=n(79968),st=n.n(ct),ut=n(43671),lt=n.n(ut),dt=n(97436),ht=n.n(dt),ft=n(6480),pt=n.n(ft),mt=n(1214),vt=n.n(mt),wt=n.p+"df95536186a5d658263c.png",Ct="E1p2ARHhtj",Et="elvJjCo914",_t="qGQqO_DNoK",gt=function(e){var t=e.children,n=e.content,r=e.placement,a=e.tipClassName,o=(0,i.useState)(!1),c=(0,h.Z)(o,2),s=c[0],u=c[1];return i.default.createElement("div",{className:Ct,onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)}},t,s&&i.default.createElement("div",{className:I()(Et,(0,d.Z)({},_t,"center"===r),a)},n))},yt={container:"UvGSSkd1qQ",header:"PBqe51NF33",windows:"Z8RjJZsXy1","logo-wrapper":"Ffl5D3J1YM",logoWrapper:"Ffl5D3J1YM",logo:"tH3c0fxDcu","operator-wrapper":"zhhA1X0YeX",operatorWrapper:"zhhA1X0YeX","operator-item-wrapper":"b4WLaPHvaN",operatorItemWrapper:"b4WLaPHvaN","operator-item":"X8XVK1EpGd",operatorItem:"X8XVK1EpGd","show-dialog":"cBwU5LVKk8 X8XVK1EpGd",showDialog:"cBwU5LVKk8 X8XVK1EpGd","hide-dialog":"MSU7d8LTb3 X8XVK1EpGd",hideDialog:"MSU7d8LTb3 X8XVK1EpGd",minimize:"uhPpW_bDvZ X8XVK1EpGd",unread:"t0DSoDjLOv","unread-open":"GQqiEMsjau",unreadOpen:"GQqiEMsjau","unread-close":"sCTuxhWsM6",unreadClose:"sCTuxhWsM6",details:"C8Jzw7jkTU","half-container":"eB3tTukA7J UvGSSkd1qQ",halfContainer:"eB3tTukA7J UvGSSkd1qQ",blank:"lBcVbnezbE","hide-blank":"qqqFtuT3WF",hideBlank:"qqqFtuT3WF",maxBlank:"AJGGbveN2k",plate:"t6aX8KMaL1",image:"zMIcJ6vtsM","error-image":"y1awX1FEiw",errorImage:"y1awX1FEiw",title:"YN8sHjfMB4","blank-title":"D_bmite0fe YN8sHjfMB4",blankTitle:"D_bmite0fe YN8sHjfMB4",reload:"nG2T6V5_Ra","error-img":"pRa93I89hk",errorImg:"pRa93I89hk","error-title":"j0EIXydtVc YN8sHjfMB4",errorTitle:"j0EIXydtVc YN8sHjfMB4"},St=n(501).t,bt=Ze((0,i.lazy)((function(){return Promise.all([n.e(951),n.e(3093),n.e(311),n.e(454),n.e(4488),n.e(7917),n.e(5177),n.e(7520),n.e(7425),n.e(3101),n.e(7106),n.e(8058),n.e(7059),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7556),n.e(8050)]).then(n.t.bind(n,72577,23))})),{name:"conversations"}),Nt={minimize:nt(),hideDialog:pt(),showDialog:ht()},Ot=function(e){var t=e.newbie,n=e.currentUser,a=e.isSubAccount,o=e.currentBuyer,c=e.loginSuccess,s=e.totalUnreadCount,u=e.showConversationDetail,l=e.currentConversation,d=(e.updateUserRequested,e.setToastInformation),h=e.toast,f=e.updateChatWindowStatus,p=e.updateConversationDetailStatus,v=e.filter,w=e.conversationBeenDeleted,C=e.markMessagesRequested,E=(e.useNewChatEntrance,e.showChatServingFeature);(0,i.useEffect)((function(){(0,m.$tracker)({operation:r.TrackerOperation.VIEW,data:{tab_name_lvl_1:v.toLowerCase(),is_chatbot_user:E}})}),[v]),(0,i.useEffect)((function(){var e=(0,m.getReportManager)();null==e||e.reportShowHomePage(!1)}),[]);var _,g={key:"minimize",tip:"header.tooltip.minimize",icon:"minimize",handler:function(e){f({showChatWindow:!1}),(0,m.$tracker)({type:"close_button"})}},y=(n.distribution_status,n.locale),S=["tw","cn"].includes((0,r.getServiceLocale)(y));return i.default.createElement("div",{style:{},className:u?yt.container:yt.halfContainer},i.default.createElement(et,null),i.default.createElement("div",{className:yt.header},i.default.createElement("div",{className:yt.logoWrapper},i.default.createElement(R(),{svg:S?lt():at(),className:yt.logo}),!!s&&i.default.createElement("div",{className:yt.unread},i.default.createElement(R(),{svg:it(),className:yt.unreadOpen}),s,i.default.createElement(R(),{svg:st(),className:yt.unreadClose}))),(_=[],u?_.push({key:"hideDialog",tip:"header.tooltip.close_dialog",icon:"hideDialog",handler:function(e){p({showConversationDetail:!1}),(0,m.$tracker)({type:"fold_button"})}}):_.push({key:"showDialog",tip:"header.tooltip.open_dialog",icon:"showDialog",handler:function(e){var t,n,r,a,o;p({showConversationDetail:!0}),n=(t=l||{}).id,r=t.status,a=t.unread_count,o=t.latest_message_id,n&&"closed"!==r&&a>0&&C({conversationId:n,isRead:!0,latestMessageId:o}),(0,m.$tracker)({type:"unfold_button"})}}),_.push(g),i.default.createElement("div",{className:yt.operatorWrapper},_.map((function(e){return i.default.createElement("div",{key:e.key,className:yt.operatorItemWrapper},i.default.createElement(gt,{content:St(e.tip)},i.default.createElement(R(),{svg:Nt[e.icon],className:yt[e.icon],onClick:e.handler})))}))))),i.default.createElement("div",{className:yt.windows},function(){var e={currentUser:n,isSubAccount:a,currentConversation:l};if(c){return"blank_page.pcmall_title",i.default.createElement(i.default.Fragment,null,i.default.createElement(ae,{toast:h,setToastInformation:d}),i.default.createElement(bt,(0,L.Z)({newbie:t},e)),i.default.createElement("div",{className:yt.details},l.id?i.default.createElement(Ge,(0,L.Z)({setToastInformation:d,currentBuyer:o},e)):i.default.createElement("div",{className:"".concat(yt.blank," ").concat(u?"":yt.hideBlank)},w?i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:yt.errorImg},i.default.createElement("img",{src:wt,className:yt.image})),i.default.createElement("div",{className:yt.errorTitle},St("conversation.server_error.deleted"))):i.default.createElement(i.default.Fragment,null,i.default.createElement(R(),{svg:vt(),className:yt.plate}),i.default.createElement("div",{className:yt.blankTitle},St("blank_page.pcmall_title")),i.default.createElement("div",{className:yt.subtitle},St("blank_page.tip"))))))}return i.default.createElement(he,null)}()))},Rt={updateUserRequested:v.updateUserRequested,setToastInformation:f.setToastInformation,updateChatWindowStatus:f.updateChatWindowStatus,updateConversationDetailStatus:f.updateConversationDetailStatus,markMessagesRequested:v.markMessagesRequested},Tt=(0,s.connect)((function(e){return{newbie:(0,f.newbieSelector)(e),toast:(0,f.toastSelector)(e),currentUser:(0,f.currentUserSelector)(e)||{},currentBuyer:(0,p.currentBuyerSelector)(e)||{},isSubAccount:(0,f.isSubAccountSelector)(e),loginSuccess:(0,f.loginSuccessSelector)(e),totalUnreadCount:(0,f.totalUnreadConversationsCountSelector)(e),currentConversation:(0,p.currentConversationSelector)(e),currentConversationId:(0,p.currentConversationIdSelector)(e),showConversationDetail:(0,f.showConversationDetailSelector)(e),filter:(0,p.filterSelector)(e),conversationBeenDeleted:(0,p.conversationBeenDeletedSelector)(e),useNewChatEntrance:(0,f.useNewChatEntranceSelector)(e),showChatServingFeature:(0,f.showChatServingFeatureSelector)(e)}}),Rt)((function(e){return i.default.createElement(Ot,e)})),kt=n(501).t,Pt=function(e){var t,n=e.showEntry,r=(e.isSubAccount,e.showChatWindow),a=e.hasUnread,o=e.handleClickEntry,c=e._counts,s=e.isCNUser,u=e.hasPermission,l=e.showDuesoonHint,f=e.handleHideHint,p=e.handleClickReplyNow,v=e.showConversationDetail,w=e.transitionClasses,C=e.setShowDuesoonHint,E=e.theme,_=e.updateChatWindowStatus,g=(0,i.useState)(!1),y=(0,h.Z)(g,2),S=y[0],b=y[1],N=(0,i.useState)(0),O=(0,h.Z)(N,2),P=(O[0],O[1]),D=(0,i.useRef)(null),A=null===(t="number"==typeof c?String(c):c)||void 0===t?void 0:t.length;(0,i.useEffect)((function(){if(n){var e=(0,m.getReportManager)();if(null==e||e.reportShowMinichat(),D.current){var t=D.current.getBoundingClientRect();P(t.width)}}}),[n]),(0,i.useEffect)((function(){r&&l&&C(!1)}),[r]);var L="\n    ".concat(T.root,"\n    ").concat(a?T.hasUnread:T.noUnread,"\n    ").concat(T[E],"\n  "),x="\n    ".concat(T.counts,"\n    ").concat(2===A?T.twoText:3===A?T.threeText:"","\n  ");return i.default.createElement("div",{className:T.chatContainer},i.default.createElement("div",{className:L,onClick:function(){r?_({showChatWindow:!1}):(b(!1),o())},onMouseEnter:function(){r||b(!0)},onMouseLeave:function(){b(!1)}},i.default.createElement("div",{className:T.chaticonWrapper},i.default.createElement(R(),{svg:"red"===E?W():U(),className:T.chatIcon})),a&&i.default.createElement("div",{className:x},c),i.default.createElement("div",{className:I()(T.expandContainer,(0,d.Z)({},T.hover,S)),style:{width:S?75:0},ref:D},i.default.createElement("div",{className:T.logo},s?"聊聊":"Chat"))),u&&l&&i.default.createElement("div",{className:T.hint},kt("entry.crr_reminder"),i.default.createElement("div",{className:T.hintFooter},i.default.createElement("div",{className:T.hideBtn,onClick:f},kt("common.maybe_later")),i.default.createElement("div",{className:T.replyBtn,onClick:p},kt("common.reply_now")))),i.default.createElement(k.Z,{unmountOnExit:!0,in:r,timeout:v?300:225,classNames:w,onEnter:null},i.default.createElement("div",{className:T.windowContainer},i.default.createElement(Tt,null))))},It=n(3488),Dt=n.n(It),Wt={"logo-wrapper":"r2v9ozyahe",logoWrapper:"r2v9ozyahe",logo:"HiSJ3Vx2WM",chat:"m3Mb2Tqdlw",counts:"v_6qeRY1jW",root:"bGX0VV9OFp",hasUnread:"nAERRUqs_I",jump:"P_7D65k6v8",jumpbar:"lCHLPQcY1b",noUnread:"VMBV0_VURc",white:"t9J4UYN3jm",red:"m_VOzMbX6j",hint:"gG0vfe2rzi",hintFooter:"xlItAfgC0G",btn:"hWgLq9FUmR","hide-btn":"Qo96nl_Au8 hWgLq9FUmR",hideBtn:"Qo96nl_Au8 hWgLq9FUmR","reply-btn":"UPQ8yWSGDT hWgLq9FUmR",replyBtn:"UPQ8yWSGDT hWgLq9FUmR",error:"EU5AP2w2pW"},At=n(501).t,Ut=function(e){var t=e.showEntry,n=e.showEntryButton,r=(e.isSubAccount,e.showChatWindow),a=e.hasUnread,o=e.handleClickEntry,c=e._counts,s=e.isCNUser,u=e.hasPermission,l=e.showDuesoonHint,d=e.handleHideHint,h=e.handleClickReplyNow,f=e.setShowEntryButton,p=e.showConversationDetail,v=e.transitionClasses,w=e.theme;(0,i.useEffect)((function(){if(t){var e=(0,m.getReportManager)();null==e||e.reportShowMinichat()}}),[t]);var C="\n    ".concat(Wt.root,"\n    ").concat(a?Wt.hasUnread:Wt.noUnread,"\n    ").concat(Wt[w],"\n  ");return i.default.createElement(i.default.Fragment,null,n&&i.default.createElement("div",{className:C},i.default.createElement("div",{className:Wt.logoWrapper,onClick:o},a&&i.default.createElement("div",{className:Wt.counts},c),i.default.createElement(R(),{svg:Dt(),className:Wt.chat}),i.default.createElement(R(),{svg:s?lt():at(),className:Wt.logo})),u&&l&&i.default.createElement("div",{className:Wt.hint},At("entry.crr_reminder"),i.default.createElement("div",{className:Wt.hintFooter},i.default.createElement("div",{className:Wt.hideBtn,onClick:d},At("common.maybe_later")),i.default.createElement("div",{className:Wt.replyBtn,onClick:h},At("common.reply_now"))))),i.default.createElement(k.Z,{unmountOnExit:!0,in:r,timeout:p?300:225,classNames:v,onEnter:null,onExited:function(){return f(!0)}},i.default.createElement(Tt,null)))},Lt="VZURjZgd48",xt="gZSXuTECya",jt="aBmy1g8C28",Mt="hG2kVJ1aJ0",qt="kFb4ptXBeH",Zt="glVxPVStQE",Bt="TylLzJLLTu glVxPVStQE",Ht="zWxOU2Js04 glVxPVStQE";function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt,Gt={updateCurTabFocused:f.updateCurTabFocused,updateChatWindowStatus:f.updateChatWindowStatus,initConversationRequested:v.initConversationRequested,closeConnection:v.closeConnectionRequested},Kt=(0,s.connect)((function(e){return{newbie:(0,f.newbieSelector)(e),showEntry:(0,f.showEntrySelector)(e),currentUser:(0,f.currentUserSelector)(e)||{},isSubAccount:(0,f.isSubAccountSelector)(e),loginSuccess:(0,f.loginSuccessSelector)(e),socketFeedback:(0,p.feedbackSelector)(e),showChatWindow:(0,f.showChatWindowSelector)(e),totalUnreadCount:(0,f.totalUnreadConversationsCountSelector)(e),showConversationDetail:(0,f.showConversationDetailSelector)(e),isMainPage:(0,f.isMainPageSelector)(e),hasFetchedUnread:(0,f.hasFetchedUnreadSelector)(e),curTabFocused:(0,f.curTabFocusedSelector)(e),totalConversationsCount:(0,p.totalConversationsCountSelector)(e),subaccountHasUnrepliedPermission:(0,f.subaccountHasUnrepliedPermissionSelector)(e),showCrrDue:(0,f.showCrrDueSelector)(e),useNewChatEntrance:(0,f.useNewChatEntranceSelector)(e)}}),Gt)((function(e){var t=e.isUseNewEntryUI,n=e.showEntry,a=e.currentUser,o=e.isSubAccount,c=e.loginSuccess,s=e.socketFeedback,u=e.showChatWindow,l=e.totalUnreadCount,d=e.showConversationDetail,f=e.updateChatWindowStatus,p=e.updateCurTabFocused,v=(e.isMainPage,e.hasFetchedUnread),C=e.curTabFocused,E=e.totalConversationsCount,_=e.subaccountHasUnrepliedPermission,g=e.showCrrDue,y=e.initConversationRequested,O=(e.closeConnection,e.useNewChatEntrance),R=l>0,T=E.duesoonCount,k=a.locale,P=(0,i.useState)(!0),I=(0,h.Z)(P,2),D=I[0],W=I[1],A=(0,i.useRef)(l),U=(0,i.useState)(""),L=(0,h.Z)(U,2),x=L[0],j=L[1],M=(0,i.useRef)(T),q=(0,i.useState)(!1),Z=(0,h.Z)(q,2),B=Z[0],H=Z[1],F=(0,i.useState)(!1),V=(0,h.Z)(F,2),z=V[0],G=V[1],K=g&&(!o||_),X=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,m.$tracker)({type:e,operation:t,data:Vt({ctx_url:window.location.href,unread_convo_cnt:l},n),page:"seller_center_chat"})};(0,i.useEffect)((function(){X("chat_icon_non_animation",r.TrackerOperation.IMPRESSION,{has_unread_convo:!!l});var e=(0,m.getReportManager)();null==e||e.reportRenderHomePage(!1)}),[]);var Y=w((function(e){p({focused:e})}),100);(0,i.useEffect)((function(){var e=A.current;D&&0===e&&l>0&&v&&C&&(0,m.$tracker)({type:"chat_icon_status_change_to_with_unread_cnt",operation:r.TrackerOperation.IMPRESSION,data:{ctx_url:window.location.href},page:"seller_center_chat"}),j(l>0?"red":"white"),A.current=l}),[l]),N("focus",(function(){return Y(!0)})),N("blur",(function(){return Y(!1)})),(0,i.useEffect)((function(){u&&W(!1)}),[u]),(0,i.useEffect)((function(){if(K){var e=M.current;T>e&&(B||(H(!0),X("chat_icon_reminder",r.TrackerOperation.IMPRESSION)),G(!0)),M.current=T}}),[T]),(0,i.useEffect)((function(){z&&(X("chat_icon_animation",r.TrackerOperation.IMPRESSION),G(!1),$e=window.setInterval((function(){j((function(e){return"red"!==e&&e?"red":"white"}))}),500),window.setTimeout((function(){$e&&clearInterval($e),$e=null,j(A.current>0?"red":"white")}),3400))}),[z]);var J=["tw","cn"].includes((0,r.getServiceLocale)(k)),Q=l>99?"99+":l,$=(0,i.useMemo)((function(){var e={enter:Lt,enterActive:jt,exit:qt,exitActive:Zt};return e.exitActive=Bt,d||((e=Vt(Vt({},e),{},{enter:xt,enterActive:Mt})).exitActive=Ht),e}),[d]);if(!n)return null;var ee=t?Pt:Ut;return i.default.createElement(ee,{showEntryButton:D,showEntry:n,isSubAccount:o,showChatWindow:u,hasUnread:R,handleClickEntry:function(){void 0===window.__CLICKED_ENTRY__&&(window.__CLICKED_ENTRY__=!0,performance.mark("ENTRY_CLICKED")),void 0===window.__OPEN_ENTRY__&&(window.__OPEN_ENTRY__=!0,window.__MINICHAT_ENTRY_CLICKED__={startTime:Date.now(),fromPage:"default"});var e=!s||s.status===r.SocketToAlertType.resolved;c&&e&&X("chat_icon",r.TrackerOperation.CLICK,{has_unread_convo:!!l,is_animation:!!$e}),f({showChatWindow:!0}),y({})},_counts:Q,isCNUser:J,hasPermission:K,showDuesoonHint:B,handleHideHint:function(){H(!1),X("chat_icon_reminder_mayber_later",r.TrackerOperation.CLICK)},handleClickReplyNow:function(){H(!1),X("chat_icon_reminder_reply_now",r.TrackerOperation.CLICK),S({currentConversation:{},webChatUrl:O?b:(0,r.getWebChatUrl)(),source:"replyNow"})},setShowEntryButton:W,showConversationDetail:d,transitionClasses:$,theme:x,setShowDuesoonHint:H,updateChatWindowStatus:f})})),Xt=n(3272),Yt=n.n(Xt),Jt=n(36459),Qt=n(11239),$t=n.n(Qt),en={counts:"CSJ2kOVBzo","two-text":"oDoG8oe4m2",twoText:"oDoG8oe4m2","three-text":"R9zBffeywE",threeText:"R9zBffeywE",root:"gnUJdG5cBP","chat-icon-wrapper":"oNdi9hoOp4",chatIconWrapper:"oNdi9hoOp4","chat-icon":"gScGBrzPpG",chatIcon:"gScGBrzPpG",red:"w4F3tmzqWq",white:"auwELGkFtE",hint:"FULMadiY5u",hintFooter:"KPWcqSw69P",btn:"_0hRNmMdk4","hide-btn":"vxkYQ8dbQ8 _0hRNmMdk4",hideBtn:"vxkYQ8dbQ8 _0hRNmMdk4","reply-btn":"IVU3aeJNrE _0hRNmMdk4",replyBtn:"IVU3aeJNrE _0hRNmMdk4",hintArrow:"p24_DwMs3V"},tn=n(501).t;function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an={updateCurTabFocused:f.updateCurTabFocused,updateChatWindowStatus:f.updateChatWindowStatus,initConversationRequested:v.initConversationRequested,closeConnection:v.closeConnectionRequested,resetConversationRequested:v.resetConversationRequested,updateConversationDetailStatus:f.updateConversationDetailStatus,setChatWithType:v.setChatWithType,updateUnreadCount:v.updateUnreadCount},on=(0,s.connect)((function(e){return{currentUser:(0,f.currentUserSelector)(e)||{},isSubAccount:(0,f.isSubAccountSelector)(e),loginSuccess:(0,f.loginSuccessSelector)(e),socketFeedback:(0,p.feedbackSelector)(e),showChatWindow:(0,f.showChatWindowSelector)(e),totalUnreadCount:(0,f.totalUnreadConversationsCountSelector)(e),isMainPage:(0,f.isMainPageSelector)(e),hasFetchedUnread:(0,f.hasFetchedUnreadSelector)(e),curTabFocused:(0,f.curTabFocusedSelector)(e),totalConversationsCount:(0,p.totalConversationsCountSelector)(e),subaccountHasUnrepliedPermission:(0,f.subaccountHasUnrepliedPermissionSelector)(e),showCrrDue:(0,f.showCrrDueSelector)(e),chatWithType:(0,p.chatWithTypeSelector)(e),sellerDriverWhitelist:(0,f.sellerDriverWhitelistSelector)(e),amsFeatureToggle:(0,f.amsFeatureToggleSelector)(e),useNewChatEntrance:(0,f.useNewChatEntranceSelector)(e),showEntry:(0,f.showEntrySelector)(e)}}),an)((function(e){var t,n=e.isSubAccount,a=e.totalConversationsCount,o=e.showChatWindow,c=(e.updateChatWindowStatus,e.totalUnreadCount),s=e.currentUser,u=e.showCrrDue,l=e.subaccountHasUnrepliedPermission,d=e.updateCurTabFocused,p=e.hasFetchedUnread,v=e.curTabFocused,C=(e.closeConnection,e.isMainPage,e.socketFeedback),E=e.loginSuccess,_=e.initConversationRequested,g=e.resetConversationRequested,y=e.updateConversationDetailStatus,O=e.updateUnreadCount,T=e.setChatWithType,k=e.chatWithType,P=e.sellerDriverWhitelist,I=e.amsFeatureToggle,D=e.useNewChatEntrance,W=e.showEntry,A=c>0,U=a.duesoonCount;(0,Jt.Z)(s);var L=(0,i.useRef)(c),x=(0,i.useState)(""),j=(0,h.Z)(x,2),M=j[0],q=j[1],Z=(0,i.useRef)(U),B=(0,i.useState)(!1),H=(0,h.Z)(B,2),F=H[0],V=H[1],z=(0,i.useState)(!1),G=(0,h.Z)(z,2),K=G[0],X=G[1],Y=u&&(!n||l),J=c>99?"99+":c,Q=null===(t="number"==typeof J?String(J):J)||void 0===t?void 0:t.length,$="\n    ".concat(en.counts,"\n    ").concat(2===Q?en.twoText:3===Q?en.threeText:""),ee=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,m.$tracker)({type:e,operation:t,data:rn({ctx_url:window.location.href,unread_convo_cnt:c},n),page:"seller_center_chat"})};(0,i.useEffect)((function(){ee("chat_icon_non_animation",r.TrackerOperation.IMPRESSION,{has_unread_convo:!!c})}),[]),(0,i.useEffect)((function(){if(W){var e=Date.now()-window.__START_MINICHAT__;(0,m.collectComponentTask)(m.ReportComponent.APP,{duration:e,id:m.ReportPoint.SHOW_WEBCHAT})}}),[W]);var te=w((function(e){d({focused:e})}),100);(0,i.useEffect)((function(){0===L.current&&c>0&&p&&v&&(0,m.$tracker)({type:"chat_icon_status_change_to_with_unread_cnt",operation:r.TrackerOperation.IMPRESSION,data:{ctx_url:window.location.href},page:"seller_center_chat"}),L.current=c}),[c]),(0,i.useEffect)((function(){o&&F&&V(!1)}),[o]),N("focus",(function(){return te(!0)})),N("blur",(function(){return te(!1)})),(0,i.useEffect)((function(){if(Y){var e=Z.current;U>e&&(F||(V(!0),ee("chat_icon_reminder",r.TrackerOperation.IMPRESSION)),X(!0)),Z.current=U}}),[U]),(0,i.useEffect)((function(){K&&(ee("chat_icon_animation",r.TrackerOperation.IMPRESSION),X(!1),zt=window.setInterval((function(){q((function(e){return"red"!==e&&e?"red":"white"}))}),500),window.setTimeout((function(){zt&&clearInterval(zt),zt=null,q("")}),3400))}),[K]),(0,i.useEffect)((function(){O({type:f.unreadCountActions.REFRESH_TOTAL_UNREAD_CONVERSATION_COUNT})}),[k]);var ne=function(e){var t=window.location.pathname.includes("/portal/sale/handover"),n=window.location.pathname.includes("/portal/web-seller-affiliate"),a=t&&P?r.ChatWithTypeEnum.Driver:n&&I?r.ChatWithTypeEnum.Affiliate:r.ChatWithTypeEnum.Buyer;k!==a&&(T({chatWithType:a}),e())};(0,i.useEffect)((function(){ne((function(){g(),y({showConversationDetail:!1})}))}),[P,I]);return i.default.createElement(Yt(),{visible:Y&&F,placement:"left",withArrow:!0,arrowClassName:en.hintArrow,getPopupContainer:function(){return window.sidebarEntryPopperContainer},content:i.default.createElement("div",{className:en.hint,onClick:function(e){e.stopPropagation()}},tn("entry.crr_reminder"),i.default.createElement("div",{className:en.hintFooter},i.default.createElement("div",{className:en.hideBtn,onClick:function(){V(!1),ee("chat_icon_reminder_mayber_later",r.TrackerOperation.CLICK)}},tn("common.maybe_later")),i.default.createElement("div",{className:en.replyBtn,onClick:function(){V(!1),ee("chat_icon_reminder_reply_now",r.TrackerOperation.CLICK),S({currentConversation:{},webChatUrl:D?b:(0,r.getWebChatUrl)(),source:"replyNow"})}},tn("common.reply_now"))))},i.default.createElement("div",{className:"".concat(en.root," ").concat(en[M]),onClick:function(){if(window.__OPEN_MINICHAT__){ne((function(){_({changeChatWithType:!0})})),void 0===window.__CLICKED_ENTRY__&&(window.__CLICKED_ENTRY__=!0,performance.mark("ENTRY_CLICKED"));var e=!C||C.status===r.SocketToAlertType.resolved;E&&e&&ee("chat_icon",r.TrackerOperation.CLICK,{has_unread_convo:!!c,is_animation:!!zt})}}},i.default.createElement("div",{className:en.chatIconWrapper},i.default.createElement(R(),{svg:$t(),className:en.chatIcon}),A&&i.default.createElement("div",{className:$},J))))})),cn="WGDkm_RPQw",sn={setToastInformation:f.setToastInformation},un=(0,s.connect)((function(e){return{toast:(0,f.toastSelector)(e),currentUser:(0,f.currentUserSelector)(e)||{},currentBuyer:(0,p.currentBuyerSelector)(e)||{},isSubAccount:(0,f.isSubAccountSelector)(e),loginSuccess:(0,f.loginSuccessSelector)(e),currentConversation:(0,p.currentConversationSelector)(e)}}),sn)((function(e){var t=e.toast,n=e.setToastInformation,r=e.currentConversation,a=e.currentBuyer,o=e.currentUser,c=e.isSubAccount;return i.default.createElement("div",{className:cn},i.default.createElement(ae,{toast:t,setToastInformation:n}),r.id?i.default.createElement(Ge,{setToastInformation:n,currentBuyer:a,currentUser:o,isSubAccount:c,currentConversation:r,isSidebarList:!0}):null)})),ln=n(7105),dn=n.n(ln),hn=n(46278),fn=n.n(hn),pn=(n(16066),n(90722)),mn=function(e){var t=e.setChatWithType,n=e.setCurrentConversationId,a=e.fetchConversationsRequested,o=e.setActiveListTab,c=e.updateConversationDetailStatus,s=e.resetConversationRequested;return(0,i.useCallback)((function(e){t({chatWithType:e}),n({conversationId:null}),a({direction:"reset",source:r.ConversationSource.FILTER}),e===r.ChatWithTypeEnum.Buyer?o({listTab:r.ConversationListTab.TODAY}):(o({listTab:r.ConversationListTab.ALL}),(0,m.$tracker)({type:"chat_with_".concat(e),section:"chat_scenario_selector",operation:r.TrackerOperation.CLICK})),c({showConversationDetail:!1}),s()}),[t,n,a,o])},vn={header:"gHC_bWpLDk","logo-wrapper":"A0RWsvHs2W",logoWrapper:"A0RWsvHs2W",logo:"_vqzuIlsF0",unread:"UAl6DMNJMZ","operator-wrapper":"fFIIYHJavp",operatorWrapper:"fFIIYHJavp","operator-item-wrapper":"ZpNyJIOulV",operatorItemWrapper:"ZpNyJIOulV","operator-item":"InZyx_tIoa",operatorItem:"InZyx_tIoa",minimize:"XE0ip_21Z8 InZyx_tIoa",headerTip:"r44sj3VHqO",select:"ia_ViubHgK",reddot:"WxrgmnpNyz"},wn=n(501).t,Cn={setChatWithType:v.setChatWithType,fetchConversationsRequested:v.fetchConversationsRequested,setCurrentConversationId:v.setCurrentConversationId,setActiveListTab:v.setActiveListTab,updateConversationDetailStatus:f.updateConversationDetailStatus,resetConversationRequested:v.resetConversationRequested},En=(0,s.connect)((function(e){return{chatWithType:(0,p.chatWithTypeSelector)(e),chatWithTypeList:(0,p.chatWithTypeListSelector)(e),allTotalConversationsCountMap:(0,p.allTotalConversationsCountMapSelector)(e)}}),Cn)((function(e){var t=e.chatWithType,n=void 0===t?r.ChatWithTypeEnum.Buyer:t,a=e.setChatWithType,o=e.fetchConversationsRequested,c=e.setCurrentConversationId,s=e.setActiveListTab,u=e.updateConversationDetailStatus,l=e.resetConversationRequested,d=e.chatWithTypeList,h=void 0===d?[]:d,f=e.allTotalConversationsCountMap;if(h.length<=1)return i.default.createElement(i.default.Fragment,null);var p=mn({setChatWithType:a,setCurrentConversationId:c,fetchConversationsRequested:o,setActiveListTab:s,updateConversationDetailStatus:u,resetConversationRequested:l});return i.default.createElement(pn.Z,{onChange:function(e){return p(e)},className:vn.select,value:n},h.map((function(e){var t;return i.default.createElement(pn.Z.Option,{key:e,value:e},wn("conversation_list.header.selector.chat_with_".concat(e)),!(null===(t=f[e])||void 0===t||!t.unreadCount)&&i.default.createElement("div",{className:vn.reddot}))})))})),_n=n(501).t,gn={minimize:fn()},yn={updateChatWindowStatus:f.updateChatWindowStatus,updateConversationDetailStatus:f.updateConversationDetailStatus,resetConversationRequested:v.resetConversationRequested},Sn=(0,s.connect)((function(e){return{currentUser:(0,f.currentUserSelector)(e)||{},totalUnreadCount:(0,f.totalUnreadConversationsCountSelector)(e),showConversationDetail:(0,f.showConversationDetailSelector)(e),currentConversation:(0,p.currentConversationSelector)(e),isSubAccount:(0,f.isSubAccountSelector)(e),chatWithType:(0,p.chatWithTypeSelector)(e),useNewChatEntrance:(0,f.useNewChatEntranceSelector)(e)}}),yn)((function(e){var t,n=e.currentUser,a=e.totalUnreadCount,o=e.showConversationDetail,c=e.updateChatWindowStatus,s=e.updateConversationDetailStatus,u=e.resetConversationRequested,l=(e.currentConversation,e.isSubAccount,e.sellerDriverWhitelist,e.chatWithType,e.useNewChatEntrance,n.locale),d=["tw","cn"].includes((0,r.getServiceLocale)(l)),h={key:"minimize",tip:"header.tooltip.minimize",icon:"minimize",handler:function(e){var t;c({showChatWindow:!1}),(0,m.$tracker)({type:"close_button"}),null===(t=window.sidebarPanelChat)||void 0===t||t.toggle(!1,"Chat"),o&&(s({showConversationDetail:!1}),u())}};return i.default.createElement("div",{className:vn.header},i.default.createElement("div",{className:vn.logoWrapper},i.default.createElement(R(),{svg:d?lt():dn(),className:vn.logo}),!!a&&i.default.createElement("div",{className:vn.unread},"(".concat(a,")")),i.default.createElement(En,null)),((t=[]).push(h),i.default.createElement("div",{className:vn.operatorWrapper},t.map((function(e){return i.default.createElement("div",{key:e.key,className:vn.operatorItemWrapper},i.default.createElement(gt,{content:_n(e.tip),tipClassName:vn.headerTip},i.default.createElement(R(),{svg:gn[e.icon],className:vn[e.icon],onClick:e.handler})))})))))})),bn="mxMfVTKqPO",Nn="wkAyvU3yRO",On=Ze((0,i.lazy)((function(){return Promise.all([n.e(951),n.e(3093),n.e(311),n.e(454),n.e(4488),n.e(7917),n.e(5177),n.e(7520),n.e(7425),n.e(3101),n.e(7106),n.e(8058),n.e(7059),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7556),n.e(8050)]).then(n.t.bind(n,72577,23))})),{name:"conversations"}),Rn=(0,s.connect)((function(e){return{currentUser:(0,f.currentUserSelector)(e)||{},isSubAccount:(0,f.isSubAccountSelector)(e),currentConversation:(0,p.currentConversationSelector)(e),newbie:(0,f.newbieSelector)(e),showConversationDetail:(0,f.showConversationDetailSelector)(e),filter:(0,p.filterSelector)(e),showChatWindow:(0,f.showChatWindowSelector)(e),showChatServingFeature:(0,f.showChatServingFeatureSelector)(e)}}),{})((function(e){var t=e.currentUser,n=e.isSubAccount,a=e.currentConversation,o=e.newbie,c=e.showConversationDetail,s=e.filter,u=e.showChatWindow,l=e.showChatServingFeature,d={currentUser:t,isSubAccount:n,currentConversation:a};return(0,i.useEffect)((function(){var e=(0,m.getReportManager)();null==e||e.reportShowHomePage(!0),null==e||e.reportRenderHomePage(!0)}),[]),(0,i.useEffect)((function(){u&&(0,m.$tracker)({operation:r.TrackerOperation.VIEW,data:{tab_name_lvl_1:s.toLowerCase(),is_chatbot_user:l}})}),[s,u]),i.default.createElement("div",{className:bn,id:"sidebar-minichat-list"},i.default.createElement(Sn,{isSubAccount:n}),i.default.createElement("div",{className:Nn},i.default.createElement(On,(0,L.Z)({isSidebarList:!0,newbie:o},d))),c&&i.default.createElement(un,null))}));(0,m.initMDAPSdk)();var Tn=(0,m.getReportManager)();null==Tn||Tn.reportLoadResource();var kn=function(e,t){c.default.render(i.default.createElement(u.zj,null,i.default.createElement(s.Provider,{store:l.store},i.default.createElement(t,null))),e)},Pn=function(e){void 0===window.__OPEN_ENTRY__&&(window.__OPEN_ENTRY__=!0,window.__MINICHAT_ENTRY_CLICKED__={startTime:Date.now(),fromPage:e})},In=function(e,t){var n,a;l.store.getState().userReducer.loginSuccess?e():(l.store.dispatch((0,f.updateChatWindowStatus)({showChatWindow:!0})),(null===(n=window.sidebarPanelChat)||void 0===n?void 0:n.toggle)&&(null===(a=window.sidebarPanelChat)||void 0===a||a.toggle(!0,"Chat")),l.store.dispatch((0,v.initConversationRequested)({})),t&&t(r.StartChatErrorCode.Login))},Dn={sellerChatInit:function(e){var t,n,r=e.isUseNewEntryUI,a=e.loadSapSdk,o=e.sidebarPanel;return console.log("****** sellerChatInit sidebarPanel ******",o),o?o.event.on("onToggle",(function(e,t){"Chat"===t&&e&&(window.__OPEN_MINICHAT__=!0,l.store.dispatch((0,v.initConversationRequested)({})),l.store.dispatch((0,f.updateChatWindowStatus)({showChatWindow:e}))),void 0!==t||e||(window.__OPEN_MINICHAT__=!1,l.store.dispatch((0,v.resetConversationRequested)()),l.store.dispatch((0,f.updateConversationDetailStatus)({showConversationDetail:!1})),l.store.dispatch((0,f.updateChatWindowStatus)({showChatWindow:e}))),void 0!==t||e||(l.store.dispatch((0,v.resetConversationRequested)()),l.store.dispatch((0,f.updateConversationDetailStatus)({showConversationDetail:!1})),l.store.dispatch((0,f.updateChatWindowStatus)({showChatWindow:e})))})):(Dn.create("shopee-mini-chat-embedded",r),console.log("****** 绑定 loadSapSdk 函数"),window.__chat_load_sap_sad_promise__=a),{mount:function(e){var i=e.iconContainer,c=e.contentContainer,s=e.popperContainer;console.log("**** 调用mount函数 hasSidebarPanel****",null==o?void 0:o.hasSidebarPanel),null!=o&&o.hasSidebarPanel?(t=i,n=c,console.log("iconContainer",t),console.log("contentContainer",n),window.sidebarEntryPopperContainer=s,window.miniChatContentContainer=n.parentNode,window.sidebarPanelChat=o,l.store.dispatch((0,f.updateHasSidebarPanel)({hasSidebarPanel:!0})),l.store.dispatch((0,f.updateConversationDetailStatus)({showConversationDetail:!1})),kn(t.parentNode,on),Pn("default"),kn(n,Rn),"Chat"===o.expandedService&&o.isExpanded&&(console.log("初始化,打开了chat panel"),window.minichatInitWindow=!0)):(console.log("**** hasSidebarPanel=false 挂载旧入口 ****"),l.store.dispatch((0,f.updateHasSidebarPanel)({hasSidebarPanel:!1})),Dn.create("shopee-mini-chat-embedded",r)),window.__chat_load_sap_sad_promise__=a},unmount:function(){var e;console.log("**** iconContainer?.parentNode****",null===(e=t)||void 0===e?void 0:e.parentNode)}}},create:function(e,t){var n=document.getElementById(e);if(!n){(n=document.createElement("div")).setAttribute("id",e);var r,a={position:"fixed",zIndex:"99999",right:"8px",bottom:"0"};for(r in a)n.style[r]=a[r];document.body.appendChild(n)}window.miniChatContainerId=e,function(e,t,n){c.default.render(i.default.createElement(u.zj,null,i.default.createElement(s.Provider,{store:l.store},i.default.createElement(e,{isUseNewEntryUI:n}))),document.getElementById(t))}(Kt,e,t)},startOrderChat:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};In((function(){l.store.dispatch((0,v.redirectConversationRequested)({userId:t,shopId:e,orderId:n,entryPointType:r.entryPoint}))})),Pn(r.entryPoint)},startChatWithText:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};In((function(){l.store.dispatch((0,v.redirectConversationRequested)({userId:e,message:t,entryPointType:n.entryPoint}))})),Pn(n.entryPoint)},startChat:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};In((function(){l.store.dispatch((0,v.redirectConversationRequested)({userId:t,shopId:e,productId:n,entryPointType:r.entryPoint}))})),Pn(r.entryPoint)},startCommonChat:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};In((function(){l.store.dispatch((0,v.redirectConversationRequested)({userId:t,shopId:e,entryPointType:{project_detail:3501,kol_marketplace_detail:3502,kol_marketplace:3503,top_five_affiliates:3504,key_metrics:3504,free_sample_detail:3505,affiliate_homepage:3506,key_metrics_detail_product:3507,key_metrics_detail_affiliate:3508,key_metrics_view_all_affiliate:3509,handover_center_page:3510,ams_find_mcn_list:3511,ams_mcn_detail:3512,ams_mcn_campaign_detail:3513}[n.entry],callback:n.onError}))}),n.onError),Pn(n.entry)},minimizeChatWindow:function(){var e,t;l.store.dispatch((0,f.updateChatWindowStatus)({showChatWindow:!1})),(null===(e=window.sidebarPanelChat)||void 0===e?void 0:e.toggle)&&(null===(t=window.sidebarPanelChat)||void 0===t||t.toggle(!1,"Chat"))},inNewBie:function(){return!1},updateLoginStatus:function(){l.store.dispatch((0,f.loginRequested)())},logout:function(){l.store.dispatch((0,f.forceLogoutRequested)())},locateMessage:function(e,t){In((function(){var n,r;e&&t&&(l.store.dispatch((0,f.updateChatWindowStatus)({showChatWindow:!0})),(null===(n=window.sidebarPanelChat)||void 0===n?void 0:n.toggle)&&(null===(r=window.sidebarPanelChat)||void 0===r||r.toggle(!0,"Chat")),l.store.dispatch((0,v.initConversationRequested)({})),l.store.dispatch((0,f.updateConversationDetailStatus)({showConversationDetail:!0})),l.store.dispatch((0,v.locationMessage)({msgId:e,shopId:t})))}))}};window.ChatEasy=Dn,"function"==typeof window.chatReady?window.chatReady():Dn.create("shopee-mini-chat-embedded",!0),Dn.create("shopee-mini-chat-embedded"),console.log("******* xxxxxxxxxxx")},53426:function(){performance&&performance.mark&&performance.mark("STATIC_LOADED")},44900:function(e,t,n){"use strict";n.r(t),n.d(t,{store:function(){return D}});var r=n(38250),a=n(38104),o=n(24360),i=n(85002),c=n(8279),s=n(42982),u=(n(35666),n(19371),n(34857)),l=n(53402),d=(n(27476),n(95767),n(98837),n(94882),n(98351),n(4942)),h=n(70885);n(83276),n(62850),n(62773);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=regeneratorRuntime.mark(w),v=regeneratorRuntime.mark(C);function w(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.payload.resource,n.t0="login"===t,!n.t0){n.next=5;break}return n.next=5,(0,u.put)((0,l.updateChatEntryStatus)({showEntry:!0}));case 5:return n.next=7,(0,u.put)((0,l.updateLoginSuccessStatus)({loginSuccess:!1}));case 7:return n.next=9,(0,u.put)((0,l.forceLogoutRequested)());case 9:case"end":return n.stop()}}),m)}function C(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.takeEvery)(l.handle401ErrorRequested,w);case 2:case"end":return e.stop()}}),v)}var E={blacklist:["userReducer"]},_={userReducer:l.userReducer,toastReducer:l.toastReducer,entityReducer:l.entityReducer,reportReducer:l.reportReducer,captchaVerifyReducer:l.captchaVerifyReducer},g=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.all)([C].concat((0,s.Z)(l.watchUserSagas),(0,s.Z)(l.watchToastSagas),(0,s.Z)(l.watchReportSagas),(0,s.Z)(l.watchHandleUrlSagas),(0,s.Z)(l.watchVerifySagas)).map(u.call));case 2:case"end":return e.stop()}}),e)})),y=n(29494),S=n(96961),b=regeneratorRuntime.mark(N);function N(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(t={operation:y.TrackerOperation.IMPRESSION,type:"chat_icon",data:{ctx_url:window.location.href,has_unread_convo:!!e,unread_convo_cnt:e}}).page="minichat_page",(0,S.$tracker)(t);case 3:case"end":return n.stop()}}),b)}var O=regeneratorRuntime.mark(T),R=regeneratorRuntime.mark(k);function T(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.select)(l.waitingTimeFilterSelector);case 2:return t=n.sent,n.next=5,(0,u.call)(a.syncConversationFilter,e,t);case 5:case"end":return n.stop()}}),O)}function k(){var e,t,n,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,u.call)(l.login);case 3:return e=o.sent,t=e.session,n=e.params,o.next=8,(0,u.put)((0,a.emptyAction)());case 8:if(!(r=t.user)){o.next=24;break}return o.next=12,(0,S.clearApiCache)();case 12:return o.next=14,(0,u.call)(l.handleLoginSucceededLogic,t,n);case 14:return o.next=16,(0,u.call)(T,r.id);case 16:return o.next=18,(0,u.put)((0,a.getGuideRequested)({userId:r.id,version:"8.7.0"}));case 18:return o.next=20,(0,u.put)((0,a.updateUnreadCount)({type:l.unreadCountActions.REFRESH_TOTAL_UNREAD_CONVERSATION_COUNT,source:y.UnreadSource.PRELOAD,callback:N}));case 20:if(!window.minichatInitWindow){o.next=24;break}return o.next=23,(0,u.put)((0,a.initConversationRequested)({}));case 23:window.minichatInitWindow=!1;case 24:o.next=32;break;case 26:return o.prev=26,o.t0=o.catch(0),console.error("[Load Chat Failed]\n",o.t0),o.next=31,(0,u.put)((0,l.updateLoginSuccessStatus)({loginSuccess:!1}));case 31:window.minichatInitWindow&&(window.minichatInitWindow=!1);case 32:case"end":return o.stop()}}),R,null,[[0,26]])}var P=n(15861),I=function(){var e=(0,P.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null,e.t0=t,e.next="input-field"===e.t0?4:"message-section"===e.t0?8:"profile"===e.t0?12:"socket"===e.t0?16:"conversations"===e.t0?20:"redirection-and-sync"===e.t0?24:"shop-selector"===e.t0?28:"settings"===e.t0?32:"user"===e.t0?36:40;break;case 4:return e.next=6,Promise.all([n.e(951),n.e(3093),n.e(311),n.e(454),n.e(785),n.e(1083),n.e(7917),n.e(7882),n.e(7026),n.e(5177),n.e(7520),n.e(7425),n.e(3101),n.e(7106),n.e(8058),n.e(5009),n.e(1395),n.e(6700),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(1593),n.e(664)]).then(n.t.bind(n,39725,23));case 6:case 10:case 14:case 18:case 22:case 26:case 30:case 34:case 38:return r=e.sent,e.abrupt("break",40);case 8:return e.next=10,Promise.all([n.e(951),n.e(3093),n.e(454),n.e(785),n.e(4488),n.e(4255),n.e(7917),n.e(6587),n.e(4746),n.e(2099),n.e(6001),n.e(3962),n.e(370),n.e(2115),n.e(6938),n.e(1222),n.e(7707),n.e(7882),n.e(7026),n.e(8846),n.e(6462),n.e(4307),n.e(3378),n.e(6308),n.e(7905),n.e(3301),n.e(6051),n.e(5177),n.e(7520),n.e(3101),n.e(7106),n.e(8058),n.e(5009),n.e(1395),n.e(5814),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7417),n.e(5282),n.e(374)]).then(n.t.bind(n,84442,23));case 12:return e.next=14,Promise.all([n.e(951),n.e(311),n.e(785),n.e(5623),n.e(7425),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7625),n.e(6845)]).then(n.t.bind(n,67625,23));case 16:return e.next=18,Promise.all([n.e(951),n.e(7882),n.e(7026),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7638)]).then(n.t.bind(n,88600,23));case 20:return e.next=22,Promise.all([n.e(951),n.e(3093),n.e(311),n.e(454),n.e(4488),n.e(7917),n.e(5177),n.e(7520),n.e(7425),n.e(3101),n.e(7106),n.e(8058),n.e(7059),n.e(9360),n.e(1868),n.e(4489),n.e(6622),n.e(7556),n.e(8050)]).then(n.t.bind(n,72577,23));case 24:return e.next=26,n.e(1324).then(n.t.bind(n,58636,23));case 28:return e.next=30,n.e(1446).then(n.t.bind(n,16366,23));case 32:return e.next=34,n.e(5571).then(n.t.bind(n,55346,23));case 36:return e.next=38,Promise.all([n.e(951),n.e(2681)]).then(n.t.bind(n,82487,23));case 40:return e.abrupt("return",r);case 41:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=(0,i.createStore)({advancedCombineReducers:function(e){return(0,r.combineReducers)(function(e,t){return Object.entries(t).reduce((function(t,n){var r=(0,h.Z)(n,2),a=r[0],o=r[1];return p(p({},t),{},(0,d.Z)({},a,(function(t,n){return n.type!=="".concat(l.reduxReset)||e.blacklist.includes(a)||(t=void 0),o(t,n)})))}),{})}(E,e))},enhancers:[],extensions:[{middleware:[o.dynamicMiddlewares]},(0,c.getSagaExtension)()]},{id:"root",reducerMap:_,sagas:[o.watchModuleAdded,g,k]});(0,o.addMiddleware)((0,o.dynamicModuleActionsMiddleware)({store:D,lazyImport:I,dynamicActions:a}))}},function(e){e.O(0,[2143],(function(){[951,3093,311,454,785,1083,7917,7882,7026,5177,7520,7425,3101,7106,8058,5009,1395,6700,9360,1868,4489,6622,1593,664,4488,4255,6587,4746,2099,6001,3962,370,2115,6938,1222,7707,8846,6462,4307,3378,6308,7905,3301,6051,5814,7417,5282,374,5623,7625,6845,7638,7059,7556,8050,1324,1446,5571,2681,2238].map(e.E)}),5);var t=function(t){return e(e.s=t)};e.O(0,[2729,7917,2038,1493,881,4444,6435,9467,7745,8592,4997,6348,7042,9360,1868,4489,6622,3789],(function(){return t(63658),t(21218)}));e.O()}]);