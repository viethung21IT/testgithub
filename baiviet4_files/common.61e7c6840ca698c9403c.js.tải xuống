(self.miniJsonp=self.miniJsonp||[]).push([[8592],{88377:function(e,t,r){var n,o,u,c,a,i,s,l,f,d;e.exports=(n=r(34857),o=r(20573),u=r(29494),c=r(96961),a=r(6678),i=r(82677),s=r(38104),l=r(58518),f=r(44900),d=r(36808),function(){"use strict";var e={701:function(e,t,r){r.d(t,{t:function(){return u}});var n=r(661),o=r.n(n),u=o().t.bind(o())},661:function(e){e.exports=l},598:function(e){e.exports=d},383:function(e){e.exports=i},252:function(e){e.exports=a},944:function(e){e.exports=n},975:function(e){e.exports=o},783:function(e){e.exports=s},644:function(e){e.exports=c},855:function(e){e.exports=u},672:function(e){e.exports=f}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var u=t[n]={exports:{}};return e[n](u,u.exports,r),u.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};return function(){r.r(p),r.d(p,{addNeedCaptchaRequest:function(){return Bo},affiliateEntitiesSelector:function(){return a},agentConversationEntitiesSelector:function(){return s},allMessageShortcutGroupsSelector:function(){return yn},amsFeatureToggleSelector:function(){return Se},authorizedShopsCountSelector:function(){return ze},autoTranslation:function(){return Vn},batchRemoveDraftHandler:function(){return pt},batchUpdateRecord:function(){return F},buyerIsFrozenSelector:function(){return ut},captchaSignatureSelector:function(){return Te},captchaVerifyReducer:function(){return eu},captchaVisibleSelector:function(){return me},chatbotToggleSelector:function(){return ie},checkUserPermissionSaga:function(){return Mr},checkUserPermissionSucceeded:function(){return xr},clearNeedCaptchaRequest:function(){return Qo},clearReportRequested:function(){return Ao},contactsEntitiesSelector:function(){return v},conversationEntitiesSelector:function(){return i},conversationsLengthLevelSelector:function(){return O},copySucceedFeedback:function(){return cn},curTabFocusedSelector:function(){return Fe},currentAllMessageShortcutsSelector:function(){return xn},currentGroupIdSelector:function(){return wn},currentGroupTypeSelector:function(){return Cn},currentMessageShortcutGroupsSelector:function(){return Nn},currentUserDistributionStatusSelector:function(){return Me},currentUserIdSelector:function(){return Z},currentUserIsSellerSelector:function(){return Je},currentUserRoleSelector:function(){return Le},currentUserSelector:function(){return Ce},currentUserShopIdSelector:function(){return xe},currentUserShopSelector:function(){return ke},deepUpdateRecord:function(){return G},deleteCaptchaRequest:function(){return Wo},deleteConfigDurationSelector:function(){return oe},deleteConfigSelector:function(){return ve},deleteConversationSucceedHandler:function(){return st},deleteRecord:function(){return H},disappearChatbotLoadingTimeSelector:function(){return fe},displayCBCBannerSelector:function(){return qn},distributionAccountStatusSelector:function(){return Qn},draftHashSelector:function(){return io},entitiesSelector:function(){return u},entityReducer:function(){return K},fetchSettings:function(){return zn},fetchSettingsStatusSelector:function(){return fo},fetchShopAuth:function(){return Zr},fetchShopsByIds:function(){return $r},fetchedShopIdsSelector:function(){return Kr},forceLogoutRequested:function(){return sr},forwardGroupMembersSelector:function(){return b},forwardGroupsEntitiesSelector:function(){return T},getConversationLastMessage:function(){return Nt},getDraft:function(){return so},getShopUnreadCountByIds:function(){return Jr},getTimestamp:function(){return bt},getToastInformation:function(){return on},handle401ErrorRequested:function(){return to},handleLoginSucceededLogic:function(){return _r},handleMessageSubscribe:function(){return ht},hasDeletePermissionSelector:function(){return ne},hasFetchedUnreadSelector:function(){return qe},hasReplyPermissionSelector:function(){return re},hasSidebarPanelSelector:function(){return Ke},hasVerifyPhoneNumberNormalSellerSelector:function(){return Xe},hasVerifyPhoneNumberSelector:function(){return Ze},hasVerifyPhoneNumberSubaccountSelector:function(){return $e},hasVideoPermissionSelector:function(){return te},hideBlockEntranceSelector:function(){return se},hideFeedbackSelector:function(){return ae},isCBSellerSelector:function(){return Ne},isMainPageSelector:function(){return He},isSubAccountSelector:function(){return ye},judgeUndefined:function(){return Rt},legacyMessageShortcutsCountSelector:function(){return Wn},loadingSelector:function(){return $},localeSelector:function(){return we},login:function(){return Er},loginRequested:function(){return ur},loginSucceeded:function(){return cr},loginSuccessSelector:function(){return We},logout:function(){return Gr},logoutHandler:function(){return Fr},logoutRequested:function(){return ar},logoutSucceeded:function(){return ir},messageEntitiesSelector:function(){return l},messageShortcutGroupEntitiesSelector:function(){return E},messageShortcutGroupHttpStatusSelector:function(){return Dn},messageShortcutGroupSelector:function(){return An},messageShortcutsSelector:function(){return Ln},messageShortcutsStatusSelector:function(){return Bn},messagesLengthLevelSelector:function(){return m},networkStatusSelector:function(){return ee},newChatEntranceSelector:function(){return Pe},newMessageFlagSelector:function(){return Ae},newbieSelector:function(){return Re},notificationTypes:function(){return It},offerSelector:function(){return co},offersSelector:function(){return oo},openMallUrl:function(){return Xn},openMallUrlSaga:function(){return Zn},orderEntitiesSelector:function(){return d},personalMessageShortcutGroupsSelector:function(){return Pn},personalMessageShortcutsSelector:function(){return In},productEntitiesSelector:function(){return S},productsSelector:function(){return Oo},pureActionHandler:function(){return Ot},pureMergeActionHandler:function(){return mt},rateCardEntitiesSelector:function(){return h},reduxReset:function(){return ao},relatedOfferIdsSelector:function(){return uo},removeSingleDraftHandler:function(){return dt},reportArraySelector:function(){return mo},reportMessageApiTimer:function(){return Dt},reportReducer:function(){return Lo},reportRequested:function(){return Ro},resendMessagePayloadSelector:function(){return be},resendNeedCaptchaRequest:function(){return qo},saveDraftHandler:function(){return St},sellerDriverWhitelistSelector:function(){return pe},serviceDownAlertSelector:function(){return tt},serviceDownClosedSelector:function(){return rt},serviceDownListSelector:function(){return nt},serviceDownMessageSelector:function(){return ot},setServiceDownStatus:function(){return Pr},setToastInformation:function(){return an},setToastInformationSaga:function(){return dn},settingsFetchStatusSelector:function(){return Gn},settingsNeedForceUpdateSelectors:function(){return Hn},settingsSelector:function(){return Mn},settingsStatusSelector:function(){return Fn},shopSelector:function(){return qr},shopStatisticsMapSelector:function(){return Ie},shopStatisticsSelector:function(){return je},shopTranslationSettingsSelector:function(){return lo},shopsEntitiesSelector:function(){return g},shopsUnreadConversationCountSelector:function(){return z},showAutoHangupModalSelector:function(){return Ye},showChatServingFeatureSelector:function(){return de},showChatWindowSelector:function(){return Be},showChatbotLoadingTimeSelector:function(){return le},showConversationDetailSelector:function(){return Ve},showCrrDueSelector:function(){return ce},showCsatSubmitSelector:function(){return _e},showEntrySelector:function(){return Qe},showRecallBannerSelector:function(){return Ee},showShop:function(){return Xr},showSourceBannerSelector:function(){return he},showTopBannerSelector:function(){return ge},sortConversations:function(){return Tt},sortedAllMessageShortcutsSelector:function(){return kn},stickerEntitiesSelector:function(){return f},subaccountHasUnrepliedPermissionSelector:function(){return Oe},takeEveryWithCancel:function(){return ou},teamMessageShortcutGroupsSelector:function(){return Un},teamMessageShortcutsSelector:function(){return jn},textBoxHeightSelector:function(){return Ge},timerHandler:function(){return Po},toastReducer:function(){return Tn},toastSelector:function(){return rn},totalUnreadConversationsCountSelector:function(){return Y},unreadCountActions:function(){return J},updateChatEntryStatus:function(){return Bt},updateChatWindowStatus:function(){return Ft},updateConversationDetailStatus:function(){return Gt},updateConversationListsHash:function(){return ro},updateCurTabFocused:function(){return Ar},updateCurTabFocusedSaga:function(){return Cr},updateCurTabFocusedSucceeded:function(){return Dr},updateEntities:function(){return L},updateHasFetchedUnread:function(){return Wt},updateHasSidebarPanel:function(){return Qt},updateIsMainPage:function(){return Rr},updateLoginSuccessStatus:function(){return Vt},updateNetworkStatus:function(){return Lt},updateOrReplaceAction:function(){return ho},updateRecord:function(){return M},updateShowAutoHangupModal:function(){return Mt},updateStatusSelector:function(){return po},updateUseNewChatEntrance:function(){return Ht},useNewChatEntranceSelector:function(){return Ue},userEntitiesSelector:function(){return c},userReducer:function(){return Qr},userSelector:function(){return De},verifyRequestsSelector:function(){return ru},voucherEntitiesSelector:function(){return _},waitingTimeFilterSelector:function(){return ue},watchHandleUrlSagas:function(){return no},watchLogin:function(){return hr},watchReportSagas:function(){return ko},watchTab:function(){return wr},watchToastSagas:function(){return mn},watchUserSagas:function(){return Wr},watchVerifySagas:function(){return tu}});var e=r(944),t=r(975),n=r(855),o=function(e){return e<=100?1:e<=500?2:e<=1e3?3:4},u=function(e){return e.entityReducer},c=(0,t.createSelector)(u,(function(e){return e.users})),a=(0,t.createSelector)(u,(function(e){return e.affiliate})),i=(0,t.createSelector)(u,(function(e){return e.conversations})),s=(0,t.createSelector)(u,(function(e){return e.agentConversations})),l=(0,t.createSelector)(u,(function(e){return function(e){return(0,n.checkEmptyObject)(e)?{}:e}(e.messages)})),f=(0,t.createSelector)(u,(function(e){return e.stickers})),d=(0,t.createSelector)(u,(function(e){return e.orders})),S=(0,t.createSelector)(u,(function(e){return e.products})),_=(0,t.createSelector)(u,(function(e){return e.vouchers})),E=(0,t.createSelector)(u,(function(e){return e.messageShortcutsGroups})),h=(0,t.createSelector)(u,(function(e){return e.rateCards})),g=(0,t.createSelector)(u,(function(e){return e.shops})),v=(0,t.createSelector)(u,(function(e){return e.contacts})),O=(0,t.createSelector)(i,s,(function(e,t){var r=Object.keys(e).length+Object.keys(t).length;return o(r)})),m=(0,t.createSelector)(l,(function(e){return o(Object.keys(e).length)})),T=(0,t.createSelector)(u,(function(e){return e.groups})),b=(0,t.createSelector)(u,(function(e){return e.groupMembers}));function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D(e,t){if(e){if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,u=[],c=!0,a=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(u.push(n.value),!t||u.length!==t);c=!0);}catch(e){a=!0,o=e}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return u}}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w,y=r(644);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.UPDATE_ENTITIES="UPDATE_ENTITIES",e.UPDATE_RECORD="UPDATE_RECORD",e.DELETE_RECORD="DELETE_RECORD",e.BATCH_UPDATE_RECORD="BATCH_UPDATE_RECORD",e.DEEP_UPDATE_RECORD="DEEP_UPDATE_RECORD"}(w||(w={}));var N,I,j=R({},w.UPDATE_ENTITIES,(function(e,t){var r=t.payload.entities;return Object.entries(r).reduce((function(e,t){var r=C(t,2),n=r[0],o=r[1];return"persist"!==n?("shops"===n&&y.shopService.updateShopMap(o),U(U({},e),{},R({},n,U(U({},e[n]),o)))):U(U({},e),{},R({},n,o))}),e)})),x=r(252),k=(0,x.createActions)((R(N={},w.UPDATE_ENTITIES,(function(e){return{entities:e.entities}})),R(N,w.UPDATE_RECORD,(function(e){return{name:e.name,id:e.id,record:e.record}})),R(N,w.DELETE_RECORD,(function(e){return{name:e.name,id:e.id}})),R(N,w.BATCH_UPDATE_RECORD,(function(e){return{name:e.name,records:e.records,checkProp:e.checkProp}})),R(N,w.DEEP_UPDATE_RECORD,(function(e){return{name:e.name,id:e.id,record:e.record}})),N)),L=k.updateEntities,M=k.updateRecord,H=k.deleteRecord,F=k.batchUpdateRecord,G=k.deepUpdateRecord;function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var W=(R(I={},w.UPDATE_RECORD,(function(e,t){var r=t.payload,n=r.name,o=r.id,u=r.record;return B(B({},e),{},R({},n,B(B({},e[n]),{},R({},o,B(B({},e[n][o]),u)))))})),R(I,w.DELETE_RECORD,(function(e,t){var r=t.payload,n=r.name,o=r.id,u=e[n];return delete u[o],B(B({},e),{},R({},n,u))})),R(I,w.BATCH_UPDATE_RECORD,(function(e,t){var r=t.payload,n=r.name,o=r.records,u=r.checkProp,c=B({},e[n]);return Object.keys(o).forEach((function(e){(!u||u&&o[e][u]>c[e][u])&&(c[e]=B(B({},c[e]),o[e]))})),B(B({},e),{},R({},n,c))})),R(I,w.DEEP_UPDATE_RECORD,(function(e,t){var r=t.payload,n=r.name,o=r.id,u=r.record,c=Object.keys(u),a={},i=B({},e[n][o]);return c.forEach((function(e){a[e]=B(B({},i[e]),u[e])})),B(B({},e),{},R({},n,B(B({},e[n]),{},R({},o,B(B({},e[n][o]),a)))))})),I);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=(0,x.handleActions)(q(q({},j),W),{users:{},affiliate:{},messages:{},conversations:{},agentConversations:{},stickers:{},orders:{},offers:{},products:{},shops:{},rateCards:{},persist:null,vouchers:{},messageShortcuts:{}}),z=function(e){var t;return(null==e||null===(t=e.socketReducer)||void 0===t?void 0:t.shopsUnreadConversationCount)||0},Y=function(e){var t;return(null==e||null===(t=e.socketReducer)||void 0===t?void 0:t.totalUnreadConversationsCount)||0},J={MARK_AS_READ:"markAsRead",MARK_AS_UNREAD:"markASUnread",CLOSE_CONVERSATION:"closeConversation",DELETE_CONVERSATION:"deleteConversation",FORWARD_CONVERSATION:"forwardConversation",RECEIVE_UNREADABLE_MESSAGE:"receiveUnreadableMessage",REFRESH_TOTAL_UNREAD_CONVERSATION_COUNT:"refreshTotalUnreadConversationCount",REFRESH_SHOPS_UNREAD_CONVERSATIONS_COUNT:"refreshShopsUnreadConversationsCount",REFRESH_SINGLE_SHOP_UNREAD_CONVERSATION_COUNT:"refreshSingleShopUnreadConversationCount",UPDATE_CONVERSATION:"updateConversation",MESSAGE_QUEUE_UPDATE:"messageQueueUpdate",MASS_READ:"mass_read",MASS_UNREAD:"mass_unread",MASS_CLOSE:"mass_close",ACTIVE_CONVERSATION:"activeConversation",CLEAR_CONVERSATION_COUNT:"clearConversationCount"},X=r(383),$=function(e){return e.userReducer.loading},Z=function(e){return e.userReducer.currentUserId},ee=function(e){return e.userReducer.networkStatus},te=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hasVideoPermission)||!1},re=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hasReplyPermission)||!1},ne=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hasDeletePermission)||!1},oe=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.deleteConfigDuration)||0},ue=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.waitingTimeFilter)||!1},ce=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showCrrDue)||!1},ae=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hideFeedback)||!1},ie=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.chatbotToggle)||0},se=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hideBlockEntrance)||!1},le=function(e){var t;return null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showChatbotLoadingTime},fe=function(e){var t;return null==e||null===(t=e.userReducer)||void 0===t?void 0:t.disappearChatbotLoadingTime},de=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showChatServingFeature)||!1},pe=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.sellerDriverWhitelist)||!1},Se=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.amsFeatureToggle)||!1},_e=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showCsatSubmit)||!1},Ee=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showRecallBanner)||!1},he=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showSourceBanner)||!1},ge=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showTopBanner)||!1},ve=function(e){var t=(null==e?void 0:e.userReducer)||{},r=t.hasDeletePermission,n=void 0!==r&&r,o=t.deleteConfigVersion,u=void 0===o?0:o,c=t.deleteConfigDuration;return{hasDeletePermission:n,deleteConfigVersion:u,deleteConfigDuration:void 0===c?0:c}},Oe=function(e){return e.userReducer.subaccountHasUnrepliedPermission},me=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.captchaVisible)||!1},Te=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.captchaSignature)||""},be=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.resendMessagePayload)||void 0},Re=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.newbie)||[]},Ae=function(e){return e.userReducer.newMessageFlag},De=function(e){return(0,t.createSelector)(u,(function(t){return(0,X.denormalize)(e,y.userSchema,{users:t})}))},Ce=(0,t.createSelector)(c,Z,(function(e,t){return(0,X.denormalize)(t,y.userSchema,{users:e})||{}})),we=(0,t.createSelector)(Ce,(function(e){return e&&e.locale})),ye=(0,t.createSelector)(Ce,(function(e){return!(0,n.checkEmptyObject)(e)&&e.type===n.AccountType.SUBACCOUNT})),Pe=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.useNewChatEntrance)||!1},Ue=(0,t.createSelector)(ye,Pe,(function(e,t){return!e&&t})),Ne=(0,t.createSelector)(Ce,(function(e){return!(0,n.checkEmptyObject)(e)&&e.is_cb})),Ie=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.shopStatisticsMap)||{}},je=function(e,r){return(0,t.createSelector)(Ie,(function(t){return t["".concat(e,"-").concat(r)]||{}}))},xe=(0,t.createSelector)(Ce,ye,(function(){return(arguments.length>1?arguments[1]:void 0)?void 0:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).shop_id})),ke=(0,t.createSelector)(Ce,ye,g,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0;return(arguments.length>1?arguments[1]:void 0)?void 0:(0,X.denormalize)(e.shop_id,y.shopSchema,{shops:t})||{}})),Le=(0,t.createSelector)(Ce,(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).role||""})),Me=(0,t.createSelector)(Ce,(function(e){return e&&e.distribution_status||""})),He=function(e){return e.userReducer.isMainPage},Fe=function(e){return e.userReducer.curTabFocused},Ge=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.textBoxHeight)||0},Ve=function(e){return e.userReducer.showConversationDetail},Be=function(e){return e.userReducer.showChatWindow},We=function(e){return e.userReducer.loginSuccess},Qe=function(e){return e.userReducer.showEntry},qe=function(e){return e.userReducer.hasFetchedUnread},Ke=function(e){return e.userReducer.hasSidebarPanel},ze=(0,t.createSelector)(Ce,(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).authorizedShopsCount||0})),Ye=function(e){return e.userReducer.showAutoHangupModal},Je=(0,t.createSelector)(Ce,ye,(function(){return!!(arguments.length>1?arguments[1]:void 0)||(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).is_seller})),Xe=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.hasVerifyPhoneNumber)||!1},$e=function(e){var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.hasVerifyPhoneNumberMap)||{}},Ze=(0,t.createSelector)(ye,Xe,$e,(function(e,t,r){return e?r:t})),et=function(e){var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.serviceDownStatus)||{}},tt=(0,t.createSelector)(et,(function(e){return e.alert||!1})),rt=(0,t.createSelector)(et,(function(e){return e.closed||!1})),nt=(0,t.createSelector)(et,(function(e){return e.list||!1})),ot=(0,t.createSelector)(et,(function(e){return e.message||!1})),ut=function(e,r,n){return(0,t.createSelector)(je(e,r),(function(e){return"frozen"===n&&"boolean"==typeof e.exist_pending_order&&!e.exist_pending_order}))};function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function at(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var it=function(e,t){var r=new Set(t);return r.delete(e),Array.from(r)},st=function(e,t){var r=t.payload.conversationId,n=at(at({},e.conversationIdsMap),{},R({},r,!1)),o=it(r,e.conversationIds),u=it(r,e.pinnedConversationIds),c=e.currentConversationId;return at(at({},e),{},{currentConversationId:c===r?null:c,conversationIds:o,pinnedConversationIds:u,conversationIdsMap:n})};function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var dt=function(e,t){var r=t.payload.conversationId,n=ft({},e.draftHash);return delete n[r],ft(ft({},e),{},{draftHash:n})},pt=function(e,t){var r=t.payload.conversationIds,n=void 0===r?[]:r,o=ft({},e.draftHash);return n.forEach((function(e){delete o[e]})),ft(ft({},e),{},{draftHash:o})},St=function(e,t){var r=t.payload,n=r.conversationId,o=r.draft,u=ft({},e.draftHash);return u[n]=o,ft(ft({},e),{},{draftHash:u})},_t=r(783),Et=regeneratorRuntime.mark(ht);function ht(t){var r,o;return regeneratorRuntime.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return r=t.payload,o=t.type,u.next=3,(0,e.spawn)(Dt,r.request_id);case 3:if(o!==n.ConversationTypeEnum.Agent){u.next=8;break}return u.next=6,(0,e.put)((0,_t.receiveAgentMessageRequested)({message:r}));case 6:u.next=10;break;case 8:return u.next=10,(0,e.put)((0,_t.receiveMessageRequested)({message:r}));case 10:case"end":return u.stop()}}),Et)}function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ot=function(){return function(e,t){var r=t.payload;return vt(vt({},e),r)}},mt=function(e){return function(t,r){var n=r.payload;return vt(vt({},t),{},R({},e,vt(vt({},t[e]),n)))}},Tt=function(e){e.sort((function(e,t){return parseInt(t.latest_message_id)-parseInt(e.latest_message_id)}))},bt=function(e,t){var r=e.last_message_time_nano,n=e.next_timestamp_nano;return t&&!n&&(n=t.next_message_time_nano),{nextTimestampNano:n,oldestTimestampNano:n,latestTimestampNano:r}},Rt=function(e){var t=e.defaultValue,r=e.value;return void 0===r?t:r},At=regeneratorRuntime.mark(Dt);function Dt(e){var t,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,n.getItem)(e);case 2:(t=o.sent)&&(null==(r=(0,y.getReportManager)())||r.reportMessageSocket(t),(0,n.removeItem)(e));case 4:case"end":return o.stop()}}),At)}var Ct,wt,yt,Pt=r(701).t,Ut=n.MessageTypes.MSG_TYPE_TEXT,Nt=function(e,t,r){var o=e.all||[],u=e.sending||[],c=e.failed||[],a=o.length,i=null;if(a){for(var s=0,l=null;s<a&&!l;){var f=e.all[s];(l=(0,X.denormalize)(f,y.messageSchema,{messages:r}))&&(l.type===n.MessageTypes.MSG_TYPE_SECURITY_TIPS||l.isFaking)&&(l=null),s++}l&&l.created_timestamp>Math.floor(t.last_message_time_nano/Math.pow(10,9))&&(i=(0,n.fillMessagePreview)(l))}if(!i){var d=t.latest_message_id,p=t.latest_message_content,S=t.latest_message_type,_=t.last_message_option,E=t.latest_message_source,h=t.last_message_time_nano;(i={id:d,content:p,type:S,message_option:_,source:E,to_shop_id:t.latest_message_to_shop_id,label_info:t.label_info}).created_at=new Date(h/1e6)+""}var g=i,v=g.id,O=g.message_option,m=u.includes(v)?n.MessageSendStatus.SENDING:c.includes(v)?n.MessageSendStatus.FAILED:i.send_status?n.MessageSendStatus.SUCCEED:null;return(0,n.hasTargetMessageOption)(O,n.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(m=n.MessageSendStatus.FAILED,i.type=Ut,i.content={text:Pt("common.blacklist.replaced_text")}),(0,n.hasTargetMessageOption)(O,n.MessageOption.MSG_OPT_CANCELORDER_WARNING_NOT_SEND)&&(m=n.MessageSendStatus.FAILED),i.send_status=m,i},It={MARK_AS_READ:"mark_as_read",MARK_AS_UNREAD:"mark_as_unread",DELETE_CONVERSATION:"delete_conversation",UPDATE_OFFER_STATUS:"update_offer_status",UPDATE_CONVERSATION:"update_conversation",UPDATE_USER_STATUS:"update_user_status",UPDATE_CONVERSATION_FLAG:"update_conversation_flag",FORCE_LOGOUT:"force_logout",UPDATE_RATING_CARD_STATUS:"update_rating_card_status",PULL_NOTIFICATION:"pull_notification",PIN_CONVERSATION:"pin_conversation",UNPIN_CONVERSATION:"unpin_conversation",MASS_READ:"mass_read",MASS_UNREAD:"mass_unread",MASS_PIN:"mass_pin",MASS_UNPIN:"mass_unpin",MASS_CLOSE:"mass_close",MASS_ACTIVATE:"mass_activate",VIDEO_UPLOAD:"video_upload",MARK_AS_REPLIED:"mark_as_replied",MARK_AS_UNREPLIED:"mark_as_unreplied",CHAT_DELETE_MSG:"chat_delete_msg",FAQ_SESSION_UPDATE:"faq_session_update",MUTE_CONVERSATION:"mute_conversation",UNMUTE_CONVERSATION:"unmute_conversation",CTT_UPDATE:"ctt_update",HAVE_UNRATED_CSAT:"have_unrated_csat",FAQ_SELLER_UNREAD_STATUS_UPDATE:"faq_seller_unread_status_update"};!function(e){e.SHOW_LOADING_SUCCEEDED="SHOW_LOADING_SUCCEEDED",e.SET_HAS_SESSION="SET_HAS_SESSION",e.UPDATE_NETWORK_STATUS="UPDATE_NETWORK_STATUS",e.UPDATE_CUR_TAB_FOCUSED="UPDATE_CUR_TAB_FOCUSED",e.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED="UPDATE_CUR_TAB_FOCUSED_SUCCEEDED",e.UPDATE_WORKSTATION_PANEL="UPDATE_WORKSTATION_PANEL",e.UPDATE_NEW_MESSAGE_FLAG="UPDATE_NEW_MESSAGE_FLAG",e.UPDATE_CHAT_WINDOW_STATUS="UPDATE_CHAT_WINDOW_STATUS",e.UPDATE_CONVERSATION_DETAIL_STATUS="UPDATE_CONVERSATION_DETAIL_STATUS",e.UPDATE_LOGIN_SUCCESS_STATUS="UPDATE_LOGIN_SUCCESS_STATUS",e.UPDATE_CHAT_ENTRY_STATUS="UPDATE_CHAT_ENTRY_STATUS",e.LOGIN_REQUESTED="LOGIN_REQUESTED",e.LOGIN_SUCCEEDED="LOGIN_SUCCEEDED",e.LOGOUT_REQUESTED="LOGOUT_REQUESTED",e.LOGOUT_SUCCEEDED="LOGOUT_SUCCEEDED",e.UPDATE_LOGIN_STATUS="UPDATE_LOGIN_STATUS",e.SHOW_TRANSLATION_GUIDE="SHOW_TRANSLATION_GUIDE",e.SHOW_REGION_FILTER_GUIDE="SHOW_REGION_FILTER_GUIDE",e.FORCE_LOGOUT_REQUESTED="FORCE_LOGOUT_REQUESTED",e.CONNECT_SOCKET="CONNECT_SOCKET",e.UPLOAD_FEEDBACK_VIDEO_REQUESTED="UPLOAD_FEEDBACK_VIDEO_REQUESTED",e.UPLOAD_FEEDBACK_VIDEO_STATUS="UPLOAD_FEEDBACK_VIDEO_STATUS",e.UPDATE_RELATED_CAPACITY="UPDATE_RELATED_CAPACITY",e.UPDATE_IS_MAIN_PAGE="UPDATE_IS_MAIN_PAGE",e.UPDATE_SHOW_AUTO_HANGUP_MODAL="UPDATE_SHOW_AUTO_HANGUP_MODAL",e.UPDATE_HAS_FETCHED_UNREAD="UPDATE_HAS_FETCHED_UNREAD",e.CHECK_USER_PERMISSION_SUCCEEDED="CHECK_USER_PERMISSION_SUCCEEDED",e.SET_SERVICE_DOWN_STATUS="SET_SERVICE_DOWN_STATUS",e.UPDATE_HAS_SIDEBAR_PANEL="UPDATE_HAS_SIDEBAR_PANEL",e.UPDATE_USE_NEW_CHAT_ENTRANCE="UPDATE_USE_NEW_CHAT_ENTRANCE"}(Ct||(Ct={}));var jt,xt,kt=(0,x.createActions)((R(wt={},Ct.UPDATE_NETWORK_STATUS,(function(e){return{networkStatus:e.networkStatus}})),R(wt,Ct.UPDATE_SHOW_AUTO_HANGUP_MODAL,(function(e){return{showAutoHangupModal:e.showAutoHangupModal}})),R(wt,Ct.UPDATE_USE_NEW_CHAT_ENTRANCE,(function(e){return{useNewChatEntrance:e.useNewChatEntrance}})),R(wt,Ct.UPDATE_CHAT_WINDOW_STATUS,(function(e){return{showChatWindow:e.showChatWindow}})),R(wt,Ct.UPDATE_CONVERSATION_DETAIL_STATUS,(function(e){return{showConversationDetail:e.showConversationDetail}})),R(wt,Ct.UPDATE_LOGIN_SUCCESS_STATUS,(function(e){return{loginSuccess:e.loginSuccess}})),R(wt,Ct.UPDATE_CHAT_ENTRY_STATUS,(function(e){return{showEntry:e.showEntry}})),R(wt,Ct.UPDATE_HAS_FETCHED_UNREAD,(function(e){return{hasFetchedUnread:e.hasFetchedUnread}})),R(wt,Ct.UPDATE_HAS_SIDEBAR_PANEL,(function(e){return{hasSidebarPanel:e.hasSidebarPanel}})),wt)),Lt=kt.updateNetworkStatus,Mt=kt.updateShowAutoHangupModal,Ht=kt.updateUseNewChatEntrance,Ft=kt.updateChatWindowStatus,Gt=kt.updateConversationDetailStatus,Vt=kt.updateLoginSuccessStatus,Bt=kt.updateChatEntryStatus,Wt=kt.updateHasFetchedUnread,Qt=kt.updateHasSidebarPanel,qt=(R(yt={},Ct.UPDATE_NETWORK_STATUS,Ot()),R(yt,Ct.UPDATE_SHOW_AUTO_HANGUP_MODAL,Ot()),R(yt,Ct.UPDATE_USE_NEW_CHAT_ENTRANCE,Ot()),R(yt,Ct.UPDATE_CHAT_WINDOW_STATUS,Ot()),R(yt,Ct.UPDATE_CONVERSATION_DETAIL_STATUS,Ot()),R(yt,Ct.UPDATE_LOGIN_SUCCESS_STATUS,Ot()),R(yt,Ct.UPDATE_CHAT_ENTRY_STATUS,Ot()),R(yt,Ct.UPDATE_HAS_FETCHED_UNREAD,Ot()),R(yt,Ct.UPDATE_HAS_SIDEBAR_PANEL,Ot()),yt),Kt=r(672),zt=r(598),Yt=r.n(zt);function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $t=regeneratorRuntime.mark(lr),Zt=regeneratorRuntime.mark(dr),er=regeneratorRuntime.mark(Sr),tr=regeneratorRuntime.mark(_r),rr=regeneratorRuntime.mark(Er),nr=regeneratorRuntime.mark(hr),or=(0,x.createActions)((R(jt={},Ct.LOGIN_REQUESTED,(function(){return{}})),R(jt,Ct.LOGIN_SUCCEEDED,(function(e){return{currentUserId:e.currentUserId,status:e.status}})),R(jt,Ct.LOGOUT_REQUESTED,(function(){return{}})),R(jt,Ct.LOGOUT_SUCCEEDED,(function(){return{}})),R(jt,Ct.FORCE_LOGOUT_REQUESTED,(function(){return{}})),jt)),ur=or.loginRequested,cr=or.loginSucceeded,ar=or.logoutRequested,ir=or.logoutSucceeded,sr=or.forceLogoutRequested;function lr(){var t,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=(0,n.getTranslationLocale)((0,n.getRuntimeLocale)()),o.next=3,(0,e.call)(y.getTranslation,{locale:t});case 3:return r=o.sent,o.next=6,(0,e.call)(n.changeLanguage,t,r);case 6:case"end":return o.stop()}}),$t)}var fr=regeneratorRuntime.mark((function t(r){var o,u,c,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=(0,y.getReportManager)(),a=window.__CHATEASY_TRANSLATION__,(0,n.checkEmptyObject)(a)||(0,n.checkEmptyObject)(a.collection)?(u=(0,n.getMallTranslationLocale)(),null==c||c.reportFetchTranslationInService()):(null==c||c.reportFetchTranslationInHtml(),i={},Object.keys(a.collection).forEach((function(e){i=Object.assign(i,a.collection[e])})),o=i,u=window.__CHATEASY_LOCALE__),o){t.next=15;break}return t.prev=4,t.next=7,(0,e.call)(y.getTranslation,{locale:u});case 7:o=t.sent,t.next=15;break;case 10:return t.prev=10,t.t0=t.catch(4),t.next=14,(0,e.call)(y.getTranslation,{locale:(0,n.getTranslationLocale)((0,n.getRuntimeLocale)())});case 14:o=t.sent;case 15:return t.next=17,(0,e.call)(n.changeLanguage,u,o);case 17:return t.next=19,(0,e.call)(n.updateTimeLocale,(0,n.getServiceLocale)(u));case 19:case"end":return t.stop()}}),t,null,[[4,10]])}));function dr(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),Zt)}var pr=regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.call)(lr);case 2:return t.next=4,(0,e.put)(Bt({showEntry:!0}));case 4:return t.next=6,(0,e.put)(Vt({loginSuccess:!1}));case 6:null==(n=(0,y.getReportManager)())||n.reportLoginFailed({type:(o=r,o instanceof y.InternalServerError?"InternalServerError":o instanceof y.Forbidden?"Forbidden":o instanceof y.Unauthoried?"Unauthoried":"Other")});case 8:case"end":return t.stop()}var o}),t)}));function Sr(){var e,t,r,n,o,u,c,a,i,s,l;return regeneratorRuntime.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:try{for(e=[],t=0,r=Object.entries(window.localStorage);t<r.length;t++)n=C(r[t],2),o=n[0],n[1],o.includes("MDAP_CONFIG_STORAGE_minichat_live_")&&(u=o.split("_")||[],c=u[u.length-1]||"",(a=c.split(".")||[]).length&&(i=a[0]?Number(a[0]):"",s=a[1]?Number(a[1]):"",l=a[2]?Number(a[2]):"",(i&&i<8||s&&s<5||5===s&&l&&l<6)&&e.push(o)));e.length&&e.forEach((function(e){window.localStorage.removeItem(e)}))}catch(e){console.log("删除MDAP发生错误")}case 2:case"end":return f.stop()}}),er)}function _r(t,r){var o,u,c,a,i,s,l,f,d,p;return regeneratorRuntime.wrap((function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,o=r.godToken,u=t.user,c=t.show_chatbot_entrance,a=u.id,i=u.type,s=u.locale,l=u.distribution_status,f=i===n.AccountType.SUBACCOUNT,window.__WEBCHAT_LOGIN__||f&&"working"===l&&(window.__WEBCHAT_LOGIN__=!0),S.next=8,(0,e.call)(fr,s||"en");case 8:return performance.mark("APP_RENDERING"),(0,y.collectLoadTask)(),(0,y.mdapConfig)(i),(0,y.configTrackerUser)(u),S.next=14,(0,e.put)(Ht({useNewChatEntrance:c}));case 14:return S.next=16,(0,e.put)(Lt({networkStatus:"online"}));case 16:return window.addEventListener("online",(function(){Kt.store.dispatch(Lt({networkStatus:"online"}))})),window.addEventListener("offline",(function(){Kt.store.dispatch(Lt({networkStatus:"offline"}))})),window.addEventListener("message",(function(e){var t;if("captcha-modal"===(null===(t=e.data)||void 0===t?void 0:t.type)){var r,o,u,c;if(3===(null===(r=e.data)||void 0===r?void 0:r.status)){var a,i,s,l=null===(a=e.data)||void 0===a?void 0:a.AC_CERT_D;l&&(0,n.isVisitingCn)()&&Yt().set("AC_CERT_D",l,{secure:!0,domain:"".concat(window.location.host),expires:new Date((new Date).getTime()+6e4)}),Kt.store.dispatch(qo()),null===(i=(s=window).closeSFUCaptchaModal)||void 0===i||i.call(s)}1===(null===(o=e.data)||void 0===o?void 0:o.status)&&(Kt.store.dispatch(Wo()),null===(u=(c=window).closeSFUCaptchaModal)||void 0===u||u.call(c))}}),!1),S.next=21,(0,e.put)(Vt({loginSuccess:!0}));case 21:return S.next=23,(0,e.put)(Bt({showEntry:!0}));case 23:return d=(0,y.normalize)("users",u),p=d.entities,S.next=26,(0,e.put)(L({entities:p}));case 26:if(o){S.next=29;break}return S.next=29,(0,e.call)(_t.startConnect);case 29:return S.next=31,(0,e.put)(cr({currentUserId:a}));case 31:return S.next=33,(0,e.call)(Mr);case 33:return S.next=35,(0,e.spawn)(dr);case 35:if(f){S.next=38;break}return S.next=38,(0,e.call)(_t.fetchShopSettings,{payload:{shopId:u.shop_id}});case 38:return S.next=40,(0,e.spawn)(Sr);case 40:S.next=46;break;case 42:return S.prev=42,S.t0=S.catch(0),S.next=46,(0,e.call)(pr,S.t0);case 46:return S.prev=46,S.finish(46);case 48:case"end":return S.stop()}}),tr,null,[[0,42,46,48]])}function Er(){var t,r,o,u,c,a,i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,performance.mark("APP_PREPARED"),o={},u="",c=(0,y.getReportManager)(),!window.__WEBCHAT_SESSION__){s.next=10;break}null==c||c.reportLoginInHtml(),o=window.__WEBCHAT_SESSION__,s.next=19;break;case 10:return null==c||c.reportLoginInService(),a={method:"POST",subServer:"coreapi",resource:"login"},i=(0,n.isVisitingCNSC)()||(0,n.isVisitingKRSC)(),a.params={source:"pcmall"},i&&(a.parent="cbsc"),s.next=17,(0,e.call)(y.fetch,a);case 17:o=s.sent,window.__WEBCHAT_SESSION__=o;case 19:return performance.mark("LOGIN_API_RESPONSED"),s.next=22,(0,n.setItem)("mini-session",o);case 22:return n.LS.setItem("mini-session",JSON.stringify(o)),n.LS.setItem("chat-locale",JSON.stringify(null===(t=o)||void 0===t||null===(r=t.user)||void 0===r?void 0:r.locale)),s.abrupt("return",{session:o,params:{godToken:u}});case 27:return s.prev=27,s.t0=s.catch(0),s.next=31,(0,e.call)(pr,s.t0);case 31:return s.prev=31,s.finish(31);case 33:case"end":return s.stop()}}),rr,null,[[0,27,31,33]])}function hr(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.takeLatest)(ur,Er);case 2:return t.next=4,(0,e.takeLatest)(ar,Gr);case 4:return t.next=6,(0,e.takeLatest)(sr,Fr);case 6:case"end":return t.stop()}}),nr)}var gr,vr,Or=(R(xt={},Ct.LOGIN_SUCCEEDED,Ot()),R(xt,Ct.LOGOUT_SUCCEEDED,(function(e){return Xt(Xt({},e),{},{currentUserId:null,performance:{},closeHangupTips:!1,hasVideoPermission:!1,captchaVisible:!1,curTabFocused:!0})})),xt),mr=regeneratorRuntime.mark(Cr),Tr=regeneratorRuntime.mark(wr),br=(0,x.createActions)((R(gr={},Ct.UPDATE_IS_MAIN_PAGE,(function(e){return{isMainPage:e.isMainPage}})),R(gr,Ct.UPDATE_CUR_TAB_FOCUSED,(function(e){return{focused:e.focused}})),R(gr,Ct.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED,(function(e){return{curTabFocused:e.curTabFocused}})),gr)),Rr=br.updateIsMainPage,Ar=br.updateCurTabFocused,Dr=br.updateCurTabFocusedSucceeded;function Cr(t){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.payload.focused)){n.next=6;break}return n.next=4,(0,e.call)(_t.tabFocused);case 4:return n.next=6,(0,e.put)(Rr({isMainPage:!0}));case 6:return n.next=8,(0,e.put)(Dr({curTabFocused:r}));case 8:case"end":return n.stop()}}),mr)}function wr(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.takeEvery)(Ar,Cr);case 2:case"end":return t.stop()}}),Tr)}var yr=(R(vr={},Ct.UPDATE_IS_MAIN_PAGE,Ot()),R(vr,Ct.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED,Ot()),vr),Pr=(0,x.createActions)(R({},Ct.SET_SERVICE_DOWN_STATUS,(function(e){return e}))).setServiceDownStatus;window.addExternalGlobal("setServiceDownStatus",Pr);var Ur=R({},Ct.SET_SERVICE_DOWN_STATUS,mt("serviceDownStatus")),Nr=regeneratorRuntime.mark(Mr);function Ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var xr=(0,x.createActions)(R({},Ct.CHECK_USER_PERMISSION_SUCCEEDED,(function(e){return{hasVideoPermission:e.hasVideoPermission,hasReplyPermission:e.hasReplyPermission,hasDeletePermission:e.hasDeletePermission,deleteConfigDuration:e.deleteConfigDuration,deleteConfigVersion:e.deleteConfigVersion,waitingTimeFilter:e.waitingTimeFilter,subaccountHasUnrepliedPermission:e.subaccountHasUnrepliedPermission,showCrrDue:e.showCrrDue,hideFeedback:e.hideFeedback,chatbotToggle:e.chatbotToggle,showChatbotLoadingTime:e.showChatbotLoadingTime,disappearChatbotLoadingTime:e.disappearChatbotLoadingTime,showChatServingFeature:e.showChatServingFeature,sellerDriverWhitelist:e.sellerDriverWhitelist,amsFeatureToggle:e.amsFeatureToggle,hideBlockEntrance:e.hideBlockEntrance,showCsatSubmit:e.showCsatSubmit,showRecallBanner:e.showRecallBanner,showSourceBanner:e.showSourceBanner,showTopBanner:e.showTopBanner}}))).checkUserPermissionSucceeded,kr={hasVideoPermission:!1,hasReplyPermission:!1,hasDeletePermission:!1,deleteConfigDuration:0,deleteConfigVersion:0,waitingTimeFilter:!1,showCrrDue:!1,hideFeedback:!1,chatbotToggle:n.ChatbotToggle.Disable,showChatbotLoadingTime:0,disappearChatbotLoadingTime:0,hideBlockEntrance:!1,showSourceBanner:!1,showTopBanner:!1},Lr=function(){try{return n.LS.getItem("minichat-service-down")||!1}catch(e){return!1}};function Mr(){var t,r,o,u,c,a,i,s,l,f,d,p,S,_,E,h,g,v,O,m,T,b,R,A,D,C,w,P,U,N,I,j,x,k;return regeneratorRuntime.wrap((function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,e.select)(Ce);case 2:return t=L.sent,r=t.type,o=t.country,L.prev=4,L.next=7,(0,e.call)(y.fetch,{subServer:"coreapi",parent:"user",resource:"global_config"});case 7:return u=L.sent,a=(c=u||{}).video,i=c.reply,s=c.waiting_time_filter,l=c.show_crr_due,f=c.delete_msg,d=c.support_subaccount_unreplied,p=c.hide_feedback,S=c.chatbot_toggle,_=c.show_chatbot_loading_time,E=c.disappear_chatbot_loading_time,h=c.show_chat_serving_feature,g=c.seller_driver_whitelist,v=c.ams_toggle_status,O=c.show_source_banner,m=c.show_top_banner,(T=void 0===(T=c.subaccount_guide_config)?{}:T).show_popup,T.popup_duration_sec,T.shop_bind_main_account,T.show_dropdown_menu_entry,b=c.show_recall_banner,R=c.hide_block_entrance,A=c.ab_test_info,D=(A=void 0===A?{}:A).show_csat_submit,(C=jr(jr({},kr),{},{hasVideoPermission:a,hasReplyPermission:i,waitingTimeFilter:s,showCrrDue:l,hideFeedback:p,chatbotToggle:S,showChatbotLoadingTime:_,disappearChatbotLoadingTime:E,showChatServingFeature:h,sellerDriverWhitelist:g,amsFeatureToggle:v,hideBlockEntrance:R,showCsatSubmit:D,showRecallBanner:b,showSourceBanner:O,showTopBanner:m})).waitingTimeFilter=!1,C.chatbotToggle=n.ChatbotToggle.Disable,C.showChatServingFeature=!1,C.sellerDriverWhitelist=!1,C.amsFeatureToggle=!1,"seller"===r?(P=(w=f||{}).config_version,U=w.region_config,N=void 0===U?[]:U,C.deleteConfigVersion=P,(I=N.find((function(e){return e.region===o})))&&I.duration&&(C.hasDeletePermission=!0,C.deleteConfigDuration=I.duration)):C.subaccountHasUnrepliedPermission=d,L.next=22,(0,e.put)(xr(jr({},C)));case 22:if(void 0===u.br_site_close){L.next=27;break}return L.next=25,(0,e.put)(Pr({alert:(null==u||null===(j=u.br_site_close)||void 0===j?void 0:j.site_close)||!1,closed:Lr()}));case 25:window.__SERVICEDOWN_STATT_TIME__=(null==u||null===(x=u.br_site_close)||void 0===x?void 0:x.start_time)||0,window.__SERVICEDOWN_END_TIME__=(null==u||null===(k=u.br_site_close)||void 0===k?void 0:k.end_time)||0;case 27:L.next=33;break;case 29:return L.prev=29,L.t0=L.catch(4),L.next=33,(0,e.put)(xr(jr({},kr)));case 33:case"end":return L.stop()}}),Nr,null,[[4,29]])}var Hr=R({},Ct.CHECK_USER_PERMISSION_SUCCEEDED,Ot()),Fr=regeneratorRuntime.mark((function t(){var r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.length>0&&void 0!==r[0]&&!r[0]){t.next=4;break}return t.next=4,(0,e.call)(_t.closeConnect);case 4:return t.next=6,(0,e.put)(ir());case 6:return t.next=8,(0,e.put)(ao());case 8:(0,n.removeItem)("mini-session"),(0,n.removeItem)("mini-sc_redirect");case 10:case"end":return t.stop()}}),t)})),Gr=regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={server:(0,n.getSCApiServer)(),namespace:"",resource:"logout/",params:{SPC_CDS:Yt().get("SPC_CDS"),SPC_CDS_VER:2}},(0,n.isVisitingCNSC)()||(0,n.isVisitingKRSC)()?(r.version="cnsc",r.parent="selleraccount"):r.version="v1",t.next=5,(0,e.call)(y.fetch,r);case 5:return document.location.replace("https://".concat((0,n.getSellerCenterUrl)(),"/account/signin")),window.removeEventListener("online",(function(){Kt.store.dispatch(Lt({networkStatus:"online"}))})),window.removeEventListener("offline",(function(){Kt.store.dispatch(Lt({networkStatus:"offline"}))})),(0,y.clearApiCache)(),t.next=11,(0,e.call)(Fr);case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),t.t0.handler?(0,e.call)(t.t0.handler):console.error("[Logout Failed] ",t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])}));function Vr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Wr=[hr,wr],Qr=(0,x.handleActions)(Br(Br(Br(Br(Br({},yr),Hr),qt),Or),Ur),{networkStatus:"online",currentUserId:null,currentUser:{},curTabFocused:!0,isMainPage:!0,subaccountHasUnrepliedPermission:!1,showAutoHangupModal:!1,hasVideoPermission:!1,hasReplyPermission:!1,shouldInitFSSDK:!1,hasDeletePermission:!1,deleteConfigVersion:0,deleteConfigDuration:0,waitingTimeFilter:!1,showCrrDue:!1,hideFeedback:!1,showChatbotLoadingTime:0,disappearChatbotLoadingTime:0,loginSuccess:!0,showChatWindow:!1,showConversationDetail:!0,showEntry:!1,hasFetchedUnread:!1,hasSidebarPanel:!1,serviceDownStatus:{alert:!1,closed:!1,list:!1,message:!1}}),qr=function(e){return(0,t.createSelector)(g,(function(t){return(0,X.denormalize)(e,y.shopSchema,{shops:t})}))},Kr=function(e){var t;return(null==e||null===(t=e.shopReducer)||void 0===t?void 0:t.fetchedShopIds)||[]},zr=regeneratorRuntime.mark(Xr),Yr=regeneratorRuntime.mark(Zr),Jr=function(e){return new Promise((function(t){(0,y.fetch)({parent:"conversation",resource:"unread-counts",params:{shop_ids:JSON.stringify(e)}}).then((function(e){var r=e["unread-counts"];t(void 0===r?[]:r)})).catch((function(){t([])}))}))};function Xr(t){var r,n,o,u;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return r=t.payload.shopId,c.prev=1,c.next=4,(0,e.select)(qr(r));case 4:return n=c.sent,c.next=7,(0,e.call)(y.fetch,{resource:"shop",id:r,params:{need_cache:1,cache_expires:600}});case 7:return n=c.sent,o=(0,y.normalize)("shops",n),u=o.entities,c.next=11,(0,e.put)(L({entities:u}));case 11:return c.next=13,(0,e.put)((0,_t.updateFetchedShopIds)({shopIds:[n.id]}));case 13:return c.abrupt("return",n);case 16:return c.prev=16,c.t0=c.catch(1),c.abrupt("return",{});case 19:case"end":return c.stop()}}),zr,null,[[1,16]])}var $r=function(e){var t=e.shopIds,r={ids:JSON.stringify(t)};return new Promise((function(e){(0,y.fetch)({resource:"shop_list",params:r}).then((function(t){var r=t.shops;e(void 0===r?[]:r)})).catch((function(){e([])}))}))};function Zr(t){var r,n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=t.payload.shopId,o.prev=1,o.next=4,(0,e.call)(y.fetch,{parent:"shop",parentId:r,resource:"auth"});case 4:return n=o.sent,o.abrupt("return",n);case 8:return o.prev=8,o.t0=o.catch(1),o.abrupt("return",{});case 11:case"end":return o.stop()}}),Yr,null,[[1,8]])}var en,tn,rn=function(e){return e.toastReducer.toast},nn=r(701).t,on=function(e,t){var r={};if(t){switch(t.type){case"auto-reply":e?t.first&&"enabled"===t.action?(r.message=nn("settings.enable_auto_reply_successfully"),r.show=!0):(r.message="",r.show=!1):(t.first&&"enabled"===t.action?r.message=nn("settings.failed_to_enable_auto_reply"):r.message="enabled"===t.action?nn("settings.failed_to_enable"):nn("settings.failed_to_disable"),r.show=!0);break;case"message":r.message=e?"save"===t.action?nn("settings.message.save_successfully"):"delete"===t.action?nn("settings.message.delete_successfully"):nn("settings.message.import_successfully"):"save"===t.action?nn("settings.message.failed_to_save"):"delete"===t.action?nn("settings.message.failed_to_delete"):nn("settings.message.failed_to_import"),r.show=!0;break;case"message-tips":e?(r.message="",r.show=!1):(r.message="enabled"===t.action?nn("settings.failed_to_enable"):nn("settings.failed_to_disable"),r.show=!0);break;case"forward":e||(r.message=403===t.status?nn("forward.exception",{forwardName:""}):nn("forward.server_error"),r.show=!0);break;case"send-feedback":r.message=nn("feedback_modal.error.failed_to_send"),r.show=!0;break;case"server-error-tips":r.message=nn("common.server_error.warning_tips"),r.show=!0;break;case"conversation-closed-tip":r.message=nn("conversation_detail.closed.warning_tips"),r.show=!0;break;case"permission-denied":r.message=nn("common.permission_denied"),r.show=!0;break;case"claim-voucher":r.message=nn(e?"voucher.claim.success":"voucher.claim.fail"),r.show=!0;break;case"claim-voucher-not-satisfy":r.message=nn("voucher.claim.fail_not_satisfy_rule"),r.show=!0;break;case"claim-voucher-already-claimed":r.message=nn("voucher.claim.fail_already_claimed"),r.show=!0;break;case"claim-voucher-no-longer-valid":r.message="claim_voucher.error.no_longer_valid",r.show=!0;break;case"claim-voucher-failed":r.message="claim_voucher.error.failed",r.show=!0;break;case"private-image":r.message=nn("common.image.expired"),r.show=!0;break;case"operation":"save"===t.action&&(r.message=nn(e?"text.save_successfully":"text.save_failed")),r.show=!0;break;default:r.message=t.message,r.show=!0}r.type=e?"success":"fail"}return r};!function(e){e.COPY_SUCCEED_FEEDBACK="COPY_SUCCEED_FEEDBACK",e.SET_TOAST_INFORMATION="SET_TOAST_INFORMATION",e.SET_TOAST_INFORMATION_SUCCEEDED="SET_TOAST_INFORMATION_SUCCEEDED"}(en||(en={}));var un=(0,x.createActions)((R(tn={},en.COPY_SUCCEED_FEEDBACK,(function(){return{}})),R(tn,en.SET_TOAST_INFORMATION,(function(e){return{type:e.type,error:e.error,toast:e.toast,extra:e.extra}})),R(tn,en.SET_TOAST_INFORMATION_SUCCEEDED,(function(e){return{toast:e.toast}})),tn)),cn=un.copySucceedFeedback,an=un.setToastInformation,sn=un.setToastInformationSucceeded,ln=regeneratorRuntime.mark(dn),fn=regeneratorRuntime.mark(pn);function dn(t){var r,n,o,u,c,a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.payload,n=r.type,o=r.error,u=r.toast,c=r.extra,i.next=3,(0,e.select)(Ve);case 3:if(!i.sent){i.next=11;break}return a=null,n&&(a=on(!1,{type:n})),void 0!==o&&(a=o instanceof y.CustomError||o instanceof y.Webview?o.handler(null==c?void 0:c.toShopId):on(!1,{type:"server-error-tips"})),u&&(a=u),i.next=11,(0,e.put)(sn({toast:a}));case 11:case"end":return i.stop()}}),ln)}function pn(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.takeEvery)(an,dn);case 2:case"end":return t.stop()}}),fn)}var Sn=R({},en.SET_TOAST_INFORMATION_SUCCEEDED,Ot()),_n=r(701).t,En=regeneratorRuntime.mark(gn),hn=regeneratorRuntime.mark(vn);function gn(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.put)(an({toast:on(!0,{message:_n("common.successful_copied")})}));case 2:case"end":return t.stop()}}),En)}function vn(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.takeEvery)(cn,gn);case 2:case"end":return t.stop()}}),hn)}function On(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var mn=[pn,vn],Tn=(0,x.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?On(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):On(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Sn),{toast:{type:"",message:"",show:!1}});function bn(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Rn,An=function(e){return e.messageShortcutGroupReducer||{groups:[],status:"",currentGroupType:-1,currentGroupId:-1}},Dn=(0,t.createSelector)(An,(function(e){return e.status})),Cn=(0,t.createSelector)(An,(function(e){return e.currentGroupType})),wn=(0,t.createSelector)(An,(function(e){return e.currentGroupId})),yn=(0,t.createSelector)(An,(function(e){return e.groups})),Pn=(0,t.createSelector)(yn,(function(e){return e.filter((function(e){return e.group_type===n.MessageShortcutGroupType.PERSONAL}))})),Un=(0,t.createSelector)(yn,(function(e){return e.filter((function(e){return e.group_type===n.MessageShortcutGroupType.TEAM}))})),Nn=(0,t.createSelector)(yn,Cn,(function(e,t){return-1===t?e:e.filter((function(e){return e.group_type===t}))})),In=(0,t.createSelector)(Pn,(function(e){return e.reduce((function(e,t){var r=t.message_shortcuts,n=void 0===r?[]:r;return e.concat(n)}),[])})),jn=(0,t.createSelector)(Un,(function(e){return e.reduce((function(e,t){var r=t.message_shortcuts,n=void 0===r?[]:r;return e.concat(n)}),[])})),xn=(0,t.createSelector)(In,jn,(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return[].concat(bn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),bn(e))})),kn=(0,t.createSelector)(xn,(function(e){var t=e.filter((function(e){return!(null==e||!e.pin_time)})).sort((function(e,t){return e.pin_time-t.pin_time})),r=e.filter((function(e){return!(null!=e&&e.pin_time)}));return[].concat(bn(t),bn(r))})),Ln=(0,t.createSelector)(kn,Cn,wn,(function(e,t,r){var n=-1===t?e:e.filter((function(e){return e.group_type===t}));return-1===r?n:n.filter((function(e){return e.groupId===r}))})),Mn=function(e){var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.settings)||{}},Hn=function(e){var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.needForceUpdate)||!1},Fn=function(e){var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.status)||""},Gn=function(e){var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.fetchStatus)||""},Vn=(0,t.createSelector)(Mn,(function(e){return e.auto_translation_status||""})),Bn=(0,t.createSelector)(Mn,(function(e){return e.message_shortcuts_status||""})),Wn=(0,t.createSelector)(Mn,(function(e){return e.legacy_message_shortcuts_count||0})),Qn=(0,t.createSelector)(Mn,(function(e){return e.distribution_account_status||"enabled"})),qn=(0,t.createSelector)(Mn,(function(e){return e.display_banner||!1})),Kn=regeneratorRuntime.mark(zn);function zn(){var t;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,e.put)((0,_t.fetchSettingsStatus)({fetchStatus:n.DataFetchStatus.PENDING}));case 3:return r.next=5,(0,e.call)(y.fetch,{parent:"user",resource:"setting"});case 5:return t=r.sent,r.next=8,(0,e.put)((0,_t.fetchSettingsSucceeded)({settings:t,fetchStatus:n.DataFetchStatus.SUCCEED,timestamp:Date.now(),needForceUpdate:!1}));case 8:return r.abrupt("return",t);case 11:return r.prev=11,r.t0=r.catch(0),r.next=15,(0,e.put)((0,_t.fetchSettingsStatus)({fetchStatus:n.DataFetchStatus.FAILED}));case 15:return r.abrupt("return",{});case 16:case"end":return r.stop()}}),Kn,null,[[0,11]])}!function(e){e.HANDLE_401_ERROR_REQUESTED="HANDLE_401_ERROR_REQUESTED",e.UPDATE_CONVERSATION_LISTS_HASH="UPDATE_CONVERSATION_LISTS_HASH",e.OPEN_MALL_URL="OPEN_MALL_URL"}(Rn||(Rn={}));var Yn=regeneratorRuntime.mark(Zn),Jn=regeneratorRuntime.mark(eo),Xn=(0,x.createActions)(R({},Rn.OPEN_MALL_URL,(function(e){return{path:e.path,region:e.region}}))).openMallUrl,$n="xiapibuy.com";function Zn(t){var r,o,u,c,a,i,s,l,f,d,p,S;return regeneratorRuntime.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:if(r=t.payload,o=r.path,u=void 0===o?"":o,c=r.region,"cn"!==(i=(a=void 0===c?"":c)?a.toLowerCase():(0,n.getRuntimeRegion)())&&"kr"!==i||(i="my"),l=u?u.startsWith("/")?u:"/".concat(u):"",!(0,n.isVisitingCn)()){_.next=21;break}return _.prev=5,_.next=8,(0,e.call)(y.fetch,{url:"https://".concat((0,n.getSCApiServer)(),"/selleraccount/nonce/get/")});case 8:f=_.sent,d=f.data,p="".concat((0,n.cnDomainHash)(i),".").concat((0,n.envPrefix)()).concat($n),S=encodeURIComponent(window.btoa('{"next":"https://'.concat(p).concat(l,'"}'))),l="/api/seller_platform/nonce/callback/?nonce=".concat(d.nonce,"&region=").concat(i,"&state=").concat(S),s="https://".concat(p).concat(l),_.next=19;break;case 16:_.prev=16,_.t0=_.catch(5),s="https://".concat((0,n.cnDomainHash)(i),".").concat((0,n.envPrefix)()).concat($n).concat(l);case 19:_.next=22;break;case 21:s="https://".concat((0,n.domainPrefix)(),".").concat((0,n.domainSuffix)(i)).concat(l);case 22:window.open(s);case 23:case"end":return _.stop()}}),Yn,null,[[5,16]])}function eo(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.takeEvery)(Xn,Zn);case 2:case"end":return t.stop()}}),Jn)}var to=(0,x.createActions)(R({},Rn.HANDLE_401_ERROR_REQUESTED,(function(e){return{resource:e.resource}}))).handle401ErrorRequested,ro=(0,x.createActions)(R({},Rn.UPDATE_CONVERSATION_LISTS_HASH,(function(){return{}}))).updateConversationListsHash,no=[eo],oo=(0,t.createSelector)(u,(function(e){return e.offers||{}})),uo=function(e,r,o,u){return(0,t.createSelector)(oo,(function(t){return Object.values(t).filter((function(t){return t.product_id===u&&t.model_id===r&&t.conversation_id===e&&t.id!==o&&t.status===n.OfferStatus.PENDING}))}))},co=function(e){return(0,t.createSelector)(u,(function(t){return(0,X.denormalize)(e,y.offerSchema,t)}))},ao=(0,x.createActions)({REDUX_RESET:function(){return{}}}).reduxReset;window.addExternalGlobal("resetAction",ao);var io=function(e){var t;return(null===(t=e.draftReducer)||void 0===t?void 0:t.draftHash)||{}},so=function(e){return(0,t.createSelector)(io,(function(t){return t[e]||""}))},lo=function(e){var t;return(null==e||null===(t=e.translatePreferenceReducer)||void 0===t?void 0:t.translationSettings)||{}},fo=function(e){var t;return(null==e||null===(t=e.translatePreferenceReducer)||void 0===t?void 0:t.fetchSettingsStatus)||""},po=function(e){var t;return(null==e||null===(t=e.translatePreferenceReducer)||void 0===t?void 0:t.updateStatus)||""},So=regeneratorRuntime.mark(ho);function _o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ho(t,r,n){var o,u,c,a,i=arguments;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o=i.length>3&&void 0!==i[3]?i[3]:[],u=t,c=[],a=[],Array.isArray(t)&&(u=((0,y.normalize)(n,t).entities||{})[n]||{}),r.forEach((function(t){var r=t.id,i=u[r];i?["conversations","agentConversations"].includes(n)&&(void 0!==i.faking||i.latestMessageStatus||void 0!==i.unreplied)?(delete(t=Eo(Eo({},i),t)).faking,delete t.latestMessageStatus,delete t.unreplied,a.push(t)):(o.length&&o.forEach((function(e){t[e]=i[e]})),c.push((0,e.put)(M({name:n,id:r,record:Eo({},t)})))):a.push(t)})),a.length&&c.push((0,e.put)(L({entities:(0,y.normalize)(n,a).entities}))),s.next=9,(0,e.all)(c);case 9:case"end":return s.stop()}}),So)}var go,vo,Oo=function(e){return(0,t.createSelector)(S,(function(t){return(0,X.denormalize)(e,[y.productSchema],{products:t})}))},mo=function(e){return e.reportReducer.beingReported};!function(e){e.REPORT_REQUESTED="REPORT_REQUESTED",e.CLEAR_REPORT_REQUESTED="CLEAR_REPORT_REQUESTED"}(go||(go={}));var To,bo=(0,x.createActions)((R(vo={},go.REPORT_REQUESTED,(function(e){return{event_time:e.event_time,url:e.url}})),R(vo,go.CLEAR_REPORT_REQUESTED,(function(){return{}})),vo)),Ro=bo.reportRequested,Ao=bo.clearReportRequested,Do=regeneratorRuntime.mark(Po),Co=regeneratorRuntime.mark(Uo);function wo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Po(){var t,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,e.select)(mo);case 2:if(!(t=o.sent).length){o.next=10;break}return r=bn(t),o.next=7,(0,e.put)(Ao());case 7:return r.sort((function(e,t){return Number(t.event_time)-Number(e.event_time)})),o.next=10,(0,e.call)(y.fetch,{method:"POST",subServer:"coreapi",parent:"user",resource:"report_active",payload:JSON.stringify(yo(yo({},r[0]),{},{platform_id:(0,n.isVisitingCNSC)()||(0,n.isVisitingKRSC)()?2:1}))});case 10:case"end":return o.stop()}}),Do)}function Uo(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,(0,e.delay)(6e4);case 3:return t.next=5,Po();case 5:t.next=0;break;case 7:case"end":return t.stop()}}),Co)}var No=(R(To={},go.REPORT_REQUESTED,(function(e,t){var r=t.payload,n=r.event_time,o=r.url;return{beingReported:[].concat(bn(e.beingReported),[{event_time:n,url:o}])}})),R(To,go.CLEAR_REPORT_REQUESTED,(function(e){return{beingReported:[]}})),To);function Io(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var jo,xo,ko=[Uo],Lo=(0,x.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Io(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},No),{beingReported:[]});function Mo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ho(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mo(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.ADD_NEED_CAPTCHA_REQUEST="ADD_NEED_CAPTCHA_REQUEST",e.DELETE_CAPTCHA_REQUEST="DELETE_CAPTCHA_REQUEST",e.CLEAR_NEED_CAPTCHA_REQUEST="CLEAR_NEED_CAPTCHA_REQUEST",e.RESEND_NEED_CAPTCHA_REQUEST="RESEND_NEED_CAPTCHA_REQUEST"}(jo||(jo={}));var Fo,Go=(R(xo={},jo.ADD_NEED_CAPTCHA_REQUEST,(function(e,t){var r=t.payload.request,n=bn(e.verifyRequests);return n.push(r),Ho(Ho({},e),{},{verifyRequests:n})})),R(xo,jo.DELETE_CAPTCHA_REQUEST,(function(e){var t=bn(e.verifyRequests);return t.pop(),Ho(Ho({},e),{},{verifyRequests:t})})),R(xo,jo.CLEAR_NEED_CAPTCHA_REQUEST,(function(e){return Ho(Ho({},e),{},{verifyRequests:[]})})),xo),Vo=(0,x.createActions)((R(Fo={},jo.ADD_NEED_CAPTCHA_REQUEST,(function(e){return{request:e.request}})),R(Fo,jo.DELETE_CAPTCHA_REQUEST,(function(){return{}})),R(Fo,jo.CLEAR_NEED_CAPTCHA_REQUEST,(function(){return{}})),R(Fo,jo.RESEND_NEED_CAPTCHA_REQUEST,(function(){return{}})),Fo)),Bo=Vo.addNeedCaptchaRequest,Wo=Vo.deleteCaptchaRequest,Qo=Vo.clearNeedCaptchaRequest,qo=Vo.resendNeedCaptchaRequest,Ko=regeneratorRuntime.mark(Xo),zo=regeneratorRuntime.mark($o);function Yo(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Jo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){a=!0,u=e},f:function(){try{c||null==r.return||r.return()}finally{if(a)throw u}}}}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xo(){var t,r,n,o,u,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,e.select)(ru);case 3:if(!(t=a.sent).length){a.next=44;break}return a.next=7,(0,e.put)(Qo());case 7:r=Yo(t),a.prev=8,r.s();case 10:if((n=r.n()).done){a.next=36;break}o=n.value,u=o.id,c=o.extra,a.t0=u,a.next="unread-count"===a.t0?16:"unread-count-single"===a.t0?19:"send-message"===a.t0?22:"orders_by_buyer"===a.t0||"purchased_list"===a.t0?25:"item-list-my-shop"===a.t0||"item-list-other-shop"===a.t0?28:"fill-handler"===a.t0?31:34;break;case 16:return a.next=18,(0,e.spawn)(_t.doRefreshTotalUnreadConversationsCount,c);case 18:return a.abrupt("break",34);case 19:return a.next=21,(0,e.spawn)(doRefreshSingleShopUnreadConversationCount,c);case 21:return a.abrupt("break",34);case 22:return a.next=24,(0,e.put)((0,_t.resendMessageRequested)(c));case 24:return a.abrupt("break",34);case 25:return a.next=27,(0,e.put)((0,_t.fetchOrdersRequested)(c));case 27:return a.abrupt("break",34);case 28:return a.next=30,(0,e.put)((0,_t.fetchProductsRequested)(c));case 30:return a.abrupt("break",34);case 31:return a.next=33,(0,e.call)(_t.fillActionHandler,c);case 33:return a.abrupt("break",34);case 34:a.next=10;break;case 36:a.next=41;break;case 38:a.prev=38,a.t1=a.catch(8),r.e(a.t1);case 41:return a.prev=41,r.f(),a.finish(41);case 44:a.next=48;break;case 46:a.prev=46,a.t2=a.catch(0);case 48:case"end":return a.stop()}}),Ko,null,[[0,46],[8,38,41,44]])}function $o(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.takeEvery)(qo,Xo);case 2:case"end":return t.stop()}}),zo)}function Zo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var eu=(0,x.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zo(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Go),{verifyRequests:[]}),tu=[$o],ru=function(e){return e.captchaVerifyReducer.verifyRequests},nu=regeneratorRuntime.mark(ou);function ou(t,r,n){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,e.takeEvery)(t,regeneratorRuntime.mark((function t(o){var u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=o.payload.id){t.next=5;break}return t.next=4,(0,e.call)(r,o);case 4:return t.abrupt("return");case 5:return t.next=7,(0,e.race)({task:(0,e.call)(r,o),cancel:(0,e.take)((function(e){return e.type===n.toString()&&e.payload.id===u}))});case 7:case"end":return t.stop()}}),t)})));case 2:case"end":return o.stop()}}),nu)}}(),p}())},53402:function(e,t,r){"use strict";e.exports=r(88377)}}]);